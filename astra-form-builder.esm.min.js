class e{constructor(){this.events=new Map}on(e,t){this.events.has(e)||this.events.set(e,[]),this.events.get(e).push(t)}emit(e,t){const a=this.events.get(e);a&&a.forEach(e=>e(t))}off(e,t){if(!t)return void this.events.delete(e);const a=this.events.get(e);if(a){const e=a.indexOf(t);e>-1&&a.splice(e,1)}}removeAllListeners(){this.events.clear()}}class t{constructor(){this.elements=new Map,this.initializeDefaultElements()}getStandardMeta(e={}){return{...t.STANDARD_META,...e}}getStandardEvents(e={}){return{...t.STANDARD_EVENTS,...e}}getStandardAlpine(e={}){return{...t.STANDARD_ALPINE,...e}}initializeDefaultElements(){this.register({id:"row",htmlTag:"row",label:"Row",icon:"üìê",category:"layout",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},columns:{type:"select",label:"Number of Columns",defaultValue:1,options:[{label:"1 Column",value:1},{label:"2 Columns",value:2},{label:"3 Columns",value:3},{label:"4 Columns",value:4}]}}}),this.register({id:"column",htmlTag:"column",label:"Column",icon:"üìè",category:"layout",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},width:{type:"select",label:"Width",defaultValue:12,options:[{label:"1/12",value:1},{label:"2/12",value:2},{label:"3/12",value:3},{label:"4/12",value:4},{label:"6/12",value:6},{label:"8/12",value:8},{label:"9/12",value:9},{label:"12/12",value:12}]}}}),this.register({id:"form",htmlTag:"form",label:"Form",icon:"üìã",category:"layout",properties:{id:{type:"text",label:"Form ID",defaultValue:"form",required:!0},name:{type:"text",label:"Form Name",defaultValue:"",required:!0},action:{type:"text",label:"Action URL",defaultValue:""},method:{type:"select",label:"Method",defaultValue:"post",options:[{label:"POST",value:"post"},{label:"GET",value:"get"}]},enctype:{type:"select",label:"Encoding Type",defaultValue:"application/x-www-form-urlencoded",options:[{label:"URL Encoded",value:"application/x-www-form-urlencoded"},{label:"Multipart Form Data",value:"multipart/form-data"},{label:"Plain Text",value:"text/plain"}]},target:{type:"select",label:"Target",defaultValue:"_self",options:[{label:"Same Window",value:"_self"},{label:"New Window",value:"_blank"},{label:"Parent Frame",value:"_parent"},{label:"Top Frame",value:"_top"}]},autocomplete:{type:"select",label:"Autocomplete",defaultValue:"on",options:[{label:"On",value:"on"},{label:"Off",value:"off"}]},novalidate:{type:"boolean",label:"No Validation",defaultValue:!1},class:{type:"text",label:"CSS Classes",defaultValue:""}},meta:{},events:{onSubmit:{type:"event",label:"On Submit",defaultValue:{action:"submitForm",target:"vanilla",parameters:{}}},onReset:{type:"event",label:"On Reset",defaultValue:{action:"resetForm",target:"vanilla",parameters:{}}}},alpine:{}}),this.register({id:"input-text",htmlTag:"input",label:"Text Input",icon:"üìù",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"text"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1},maxLength:{type:"number",label:"Max Characters",defaultValue:100}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Text Field"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-email",htmlTag:"input",label:"Email",icon:"üìß",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"email"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:"your@email.com"},required:{type:"boolean",label:"Required",defaultValue:!0}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Email"},icon:{type:"text",label:"Icon",defaultValue:"üìß"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"textarea",htmlTag:"textarea",label:"Long Text",icon:"üìÑ",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:""},rows:{type:"number",label:"Rows",defaultValue:4},required:{type:"boolean",label:"Required",defaultValue:!1},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Long Text"},icon:{type:"text",label:"Icon",defaultValue:"üìÑ"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"select",htmlTag:"select",label:"Select",icon:"üìã",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},options:{type:"textarea",label:"Options (one per line)",defaultValue:"Option 1\nOption 2\nOption 3",description:"Enter one option per line"},required:{type:"boolean",label:"Required",defaultValue:!1},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Select an option"},icon:{type:"text",label:"Icon",defaultValue:"üìã"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-number",htmlTag:"input",label:"Number",icon:"üî¢",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"number"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:""},min:{type:"number",label:"Min Value",defaultValue:0},max:{type:"number",label:"Max Value",defaultValue:100},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Number"},icon:{type:"text",label:"Icon",defaultValue:"üî¢"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"checkbox",htmlTag:"checkbox",label:"Checkbox",icon:"‚òëÔ∏è",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},value:{type:"text",label:"Value",defaultValue:"1"},checked:{type:"boolean",label:"Checked by default",defaultValue:!1},required:{type:"boolean",label:"Required",defaultValue:!1},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Check this option"},icon:{type:"text",label:"Icon",defaultValue:"‚òëÔ∏è"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-password",htmlTag:"input",label:"Password",icon:"üîí",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"password"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1},minLength:{type:"number",label:"Min Length",defaultValue:0},maxLength:{type:"number",label:"Max Length",defaultValue:100},autocomplete:{type:"select",label:"Autocomplete",defaultValue:"current-password",options:[{label:"Current Password",value:"current-password"},{label:"New Password",value:"new-password"},{label:"Off",value:"off"}]}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Password"},icon:{type:"text",label:"Icon",defaultValue:"üîí"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-radio",htmlTag:"input",label:"Radio Button",icon:"üîò",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"radio"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},value:{type:"text",label:"Value",defaultValue:""}},meta:this.getStandardMeta({icon:{type:"text",label:"Icon",defaultValue:"üîò"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"button",htmlTag:"button",label:"Button",icon:"üî≤",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},type:{type:"select",label:"Type",defaultValue:"button",options:[{label:"Button",value:"button"},{label:"Submit",value:"submit"},{label:"Reset",value:"reset"}]},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({icon:{type:"text",label:"Icon",defaultValue:"üî≤"}}),events:this.getStandardEvents({onClick:{type:"event",label:"On Click (click)",defaultValue:{action:"submit",target:"vanilla",parameters:{}}}}),alpine:this.getStandardAlpine()}),this.register({id:"input-submit",htmlTag:"input",label:"Submit Button",icon:"üî≤",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"submit"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({icon:{type:"text",label:"Icon",defaultValue:"üî≤"}}),events:this.getStandardEvents({onClick:{type:"event",label:"On Click (click)",defaultValue:{action:"submit",target:"vanilla",parameters:{}}}}),alpine:this.getStandardAlpine()}),this.register({id:"input-reset",htmlTag:"input",label:"Reset Button",icon:"üî≤",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"reset"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({icon:{type:"text",label:"Icon",defaultValue:"üî≤"}}),events:this.getStandardEvents({onClick:{type:"event",label:"On Click (click)",defaultValue:{action:"submit",target:"vanilla",parameters:{}}}}),alpine:this.getStandardAlpine()}),this.register({id:"input-url",htmlTag:"input",label:"URL",icon:"üåê",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"url"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:"https://example.com"},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Website URL"},icon:{type:"text",label:"Icon",defaultValue:"üåê"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-tel",htmlTag:"input",label:"Telephone",icon:"üìû",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"tel"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:"+1 (555) 123-4567"},pattern:{type:"text",label:"Pattern (Regex)",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Phone Number"},icon:{type:"text",label:"Icon",defaultValue:"üìû"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-search",htmlTag:"input",label:"Search",icon:"üîç",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"search"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},placeholder:{type:"text",label:"Placeholder",defaultValue:"Search..."},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Search"},icon:{type:"text",label:"Icon",defaultValue:"üîç"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-date",htmlTag:"input",label:"Date",icon:"üìÖ",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"date"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},min:{type:"text",label:"Min Date",defaultValue:""},max:{type:"text",label:"Max Date",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Date"},icon:{type:"text",label:"Icon",defaultValue:"üìÖ"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-time",htmlTag:"input",label:"Time",icon:"üïê",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"time"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},min:{type:"text",label:"Min Time",defaultValue:""},max:{type:"text",label:"Max Time",defaultValue:""},step:{type:"number",label:"Step (seconds)",defaultValue:60},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Time"},icon:{type:"text",label:"Icon",defaultValue:"üïê"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-datetime-local",htmlTag:"input",label:"Date & Time",icon:"üìÖüïê",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"datetime-local"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},min:{type:"text",label:"Min DateTime",defaultValue:""},max:{type:"text",label:"Max DateTime",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Date & Time"},icon:{type:"text",label:"Icon",defaultValue:"üìÖüïê"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-month",htmlTag:"input",label:"Month",icon:"üìÜ",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"month"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},min:{type:"text",label:"Min Month",defaultValue:""},max:{type:"text",label:"Max Month",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Month"},icon:{type:"text",label:"Icon",defaultValue:"üìÜ"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-week",htmlTag:"input",label:"Week",icon:"üóìÔ∏è",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"week"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},min:{type:"text",label:"Min Week",defaultValue:""},max:{type:"text",label:"Max Week",defaultValue:""},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Week"},icon:{type:"text",label:"Icon",defaultValue:"üóìÔ∏è"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-color",htmlTag:"input",label:"Color Picker",icon:"üé®",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"color"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},value:{type:"text",label:"Default Color",defaultValue:"#000000"}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Choose Color"},icon:{type:"text",label:"Icon",defaultValue:"üé®"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-range",htmlTag:"input",label:"Range Slider",icon:"üéöÔ∏è",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"range"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},min:{type:"number",label:"Min Value",defaultValue:0},max:{type:"number",label:"Max Value",defaultValue:100},step:{type:"number",label:"Step",defaultValue:1},value:{type:"number",label:"Default Value",defaultValue:50}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Range"},icon:{type:"text",label:"Icon",defaultValue:"üéöÔ∏è"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-file",htmlTag:"input",label:"File Upload",icon:"üìÅ",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"file"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},accept:{type:"text",label:"Accept File Types",defaultValue:"",description:"e.g., .jpg,.png,.pdf or image/*"},multiple:{type:"boolean",label:"Multiple Files",defaultValue:!1},required:{type:"boolean",label:"Required",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Upload File"},icon:{type:"text",label:"Icon",defaultValue:"üìÅ"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"input-hidden",htmlTag:"input",label:"Hidden Field",icon:"üôà",category:"form",properties:{type:{type:"fixed",label:"Type",defaultValue:"hidden"},id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},value:{type:"text",label:"Value",defaultValue:""}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Hidden Field"},icon:{type:"text",label:"Icon",defaultValue:"üôà"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"fieldset",htmlTag:"fieldset",label:"Fieldset",icon:"üóÇÔ∏è",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},disabled:{type:"boolean",label:"Disabled",defaultValue:!1}},meta:this.getStandardMeta({label:{type:"text",label:"Legend",defaultValue:"Group"},icon:{type:"text",label:"Icon",defaultValue:"üóÇÔ∏è"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"legend",htmlTag:"legend",label:"Legend",icon:"üìã",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0}},meta:this.getStandardMeta({label:{type:"text",label:"Text",defaultValue:"Legend Text"},icon:{type:"text",label:"Icon",defaultValue:"üìã"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"label",htmlTag:"label",label:"Label",icon:"üè∑Ô∏è",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},for:{type:"text",label:"For (Target Input ID)",defaultValue:""}},meta:this.getStandardMeta({label:{type:"text",label:"Text",defaultValue:"Label Text"},icon:{type:"text",label:"Icon",defaultValue:"üè∑Ô∏è"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"datalist",htmlTag:"datalist",label:"Datalist",icon:"üìùüìã",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},options:{type:"textarea",label:"Options (one per line)",defaultValue:"Option 1\nOption 2\nOption 3",description:"Enter one option per line"}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Suggestions"},icon:{type:"text",label:"Icon",defaultValue:"üìùüìã"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"output",htmlTag:"output",label:"Output",icon:"üì§",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},name:{type:"text",label:"Name",defaultValue:"",required:!0},for:{type:"text",label:"For (Related Input IDs)",defaultValue:"",description:"Space-separated list of related input IDs"}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Result"},icon:{type:"text",label:"Icon",defaultValue:"üì§"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"progress",htmlTag:"progress",label:"Progress Bar",icon:"üìä",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},value:{type:"number",label:"Value",defaultValue:50},max:{type:"number",label:"Max Value",defaultValue:100}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Progress"},icon:{type:"text",label:"Icon",defaultValue:"üìä"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"meter",htmlTag:"meter",label:"Meter",icon:"üìèüìä",category:"form",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},value:{type:"number",label:"Value",defaultValue:6},min:{type:"number",label:"Min Value",defaultValue:0},max:{type:"number",label:"Max Value",defaultValue:10},low:{type:"number",label:"Low Threshold",defaultValue:3},high:{type:"number",label:"High Threshold",defaultValue:8},optimum:{type:"number",label:"Optimum Value",defaultValue:9}},meta:this.getStandardMeta({label:{type:"text",label:"Label",defaultValue:"Meter"},icon:{type:"text",label:"Icon",defaultValue:"üìèüìä"}}),events:this.getStandardEvents(),alpine:this.getStandardAlpine()}),this.register({id:"h1",htmlTag:"h1",label:"Heading 1",icon:"üì∞",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Main Heading"}},events:{},alpine:{}}),this.register({id:"h2",htmlTag:"h2",label:"Heading 2",icon:"üìÑ",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Section Heading"}},events:{},alpine:{}}),this.register({id:"h3",htmlTag:"h3",label:"Heading 3",icon:"üìÉ",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Subsection Heading"}},events:{},alpine:{}}),this.register({id:"h4",htmlTag:"h4",label:"Heading 4",icon:"üìù",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Minor Heading"}},events:{},alpine:{}}),this.register({id:"h5",htmlTag:"h5",label:"Heading 5",icon:"üìú",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Small Heading"}},events:{},alpine:{}}),this.register({id:"h6",htmlTag:"h6",label:"Heading 6",icon:"üóíÔ∏è",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Smallest Heading"}},events:{},alpine:{}}),this.register({id:"paragraph",htmlTag:"p",label:"Paragraph",icon:"üìÉ",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"This is a paragraph of text."}},events:{},alpine:{}}),this.register({id:"pre",htmlTag:"pre",label:"Preformatted Text",icon:"üìÑ",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"This is preformatted text.\n  Spaces and line breaks\n    are preserved exactly."}},events:{},alpine:{}}),this.register({id:"code",htmlTag:"code",label:"Code",icon:"üíª",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:"language-javascript"},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:'console.log("Hello, World!");'}},events:{},alpine:{}}),this.register({id:"blockquote",htmlTag:"blockquote",label:"Blockquote",icon:"üí¨",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},cite:{type:"text",label:"Citation URL",defaultValue:""},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({label:{type:"textarea",label:"Quote Text",defaultValue:"This is a quotation from another source."},icon:{type:"text",label:"Icon",defaultValue:"üí¨"},author:{type:"text",label:"Author",defaultValue:""}})}),this.register({id:"hr",htmlTag:"hr",label:"Horizontal Rule",icon:"‚ûñ",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{},events:{},alpine:{}}),this.register({id:"br",htmlTag:"br",label:"Line Break",icon:"‚Ü©Ô∏è",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""}}}),this.register({id:"div",htmlTag:"div",label:"Division",icon:"üì¶",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:this.getStandardMeta({innerHTML:{type:"textarea",label:"Content",defaultValue:"Container content"}})}),this.register({id:"span",htmlTag:"span",label:"Span",icon:"üè∑Ô∏è",category:"content",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}},meta:{innerHTML:{type:"textarea",label:"Content",defaultValue:"Inline text"}},events:{},alpine:{}}),this.register({id:"image",htmlTag:"img",label:"Image",icon:"üñºÔ∏è",category:"media",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},src:{type:"text",label:"Source URL",defaultValue:"https://via.placeholder.com/300x200",required:!0},alt:{type:"text",label:"Alt Text",defaultValue:"Placeholder image",required:!0},width:{type:"number",label:"Width",defaultValue:300},height:{type:"number",label:"Height",defaultValue:200},title:{type:"text",label:"Title (Tooltip)",defaultValue:""},loading:{type:"select",label:"Loading",defaultValue:"lazy",options:[{value:"lazy",label:"Lazy"},{value:"eager",label:"Eager"}]},decoding:{type:"select",label:"Decoding",defaultValue:"auto",options:[{value:"auto",label:"Auto"},{value:"sync",label:"Sync"},{value:"async",label:"Async"}]},crossorigin:{type:"select",label:"Cross Origin",defaultValue:"",options:[{value:"",label:"None"},{value:"anonymous",label:"Anonymous"},{value:"use-credentials",label:"Use Credentials"}]},referrerpolicy:{type:"select",label:"Referrer Policy",defaultValue:"",options:[{value:"",label:"Default"},{value:"no-referrer",label:"No Referrer"},{value:"no-referrer-when-downgrade",label:"No Referrer When Downgrade"},{value:"origin",label:"Origin"},{value:"origin-when-cross-origin",label:"Origin When Cross Origin"},{value:"same-origin",label:"Same Origin"},{value:"strict-origin",label:"Strict Origin"},{value:"strict-origin-when-cross-origin",label:"Strict Origin When Cross Origin"},{value:"unsafe-url",label:"Unsafe URL"}]},sizes:{type:"text",label:"Sizes",defaultValue:"",description:"e.g., (max-width: 600px) 100vw, 50vw"},srcset:{type:"textarea",label:"Srcset (Responsive Images)",defaultValue:"",description:"e.g., small.jpg 480w, medium.jpg 800w, large.jpg 1200w"},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}}}),this.register({id:"video",htmlTag:"video",label:"Video",icon:"üé•",category:"media",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},src:{type:"text",label:"Source URL",defaultValue:""},controls:{type:"boolean",label:"Show Controls",defaultValue:!0},autoplay:{type:"boolean",label:"Autoplay",defaultValue:!1},muted:{type:"boolean",label:"Muted",defaultValue:!1},loop:{type:"boolean",label:"Loop",defaultValue:!1},poster:{type:"text",label:"Poster Image URL",defaultValue:""},width:{type:"number",label:"Width",defaultValue:640},height:{type:"number",label:"Height",defaultValue:360}}}),this.register({id:"audio",htmlTag:"audio",label:"Audio",icon:"üéµ",category:"media",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},src:{type:"text",label:"Source URL",defaultValue:""},controls:{type:"boolean",label:"Show Controls",defaultValue:!0},autoplay:{type:"boolean",label:"Autoplay",defaultValue:!1},muted:{type:"boolean",label:"Muted",defaultValue:!1},loop:{type:"boolean",label:"Loop",defaultValue:!1}}}),this.register({id:"iframe",htmlTag:"iframe",label:"IFrame",icon:"üñºÔ∏èüì±",category:"media",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},src:{type:"text",label:"Source URL",defaultValue:"https://www.example.com"},width:{type:"number",label:"Width",defaultValue:640},height:{type:"number",label:"Height",defaultValue:480},frameborder:{type:"select",label:"Frame Border",defaultValue:"0",options:[{value:"0",label:"No Border"},{value:"1",label:"With Border"}]},allowfullscreen:{type:"boolean",label:"Allow Fullscreen",defaultValue:!1},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}}}),this.register({id:"canvas",htmlTag:"canvas",label:"Canvas",icon:"üé®",category:"media",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},width:{type:"number",label:"Width",defaultValue:300},height:{type:"number",label:"Height",defaultValue:150},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}}}),this.register({id:"svg",htmlTag:"svg",label:"SVG",icon:"üñåÔ∏è",category:"media",properties:{id:{type:"text",label:"ID",defaultValue:"",required:!0},width:{type:"number",label:"Width",defaultValue:100},height:{type:"number",label:"Height",defaultValue:100},viewBox:{type:"text",label:"ViewBox",defaultValue:"0 0 100 100"},class:{type:"text",label:"CSS Class",defaultValue:""},style:{type:"text",label:"Inline Style",defaultValue:""}}})}register(e){this.elements.set(e.id,e)}unregister(e){this.elements.delete(e)}get(e){return this.elements.get(e)}getAll(){return Array.from(this.elements.values())}getByCategory(e){return this.getAll().filter(t=>t.category===e)}has(e){return this.elements.has(e)}static validateRegistry(e){try{for(const[t,a]of Object.entries(e)){if(!a.id||a.id!==t)throw Error(`Element "${t}": Invalid or missing ID`);if(!a.htmlTag||"string"!=typeof a.htmlTag)throw Error(`Element "${t}": Invalid or missing htmlTag`);if(!a.label||"string"!=typeof a.label)throw Error(`Element "${t}": Invalid or missing label`);if(a.properties&&"object"!=typeof a.properties)throw Error(`Element "${t}": Properties must be an object`);if(a.meta&&"object"!=typeof a.meta)throw Error(`Element "${t}": Meta must be an object`);if(a.events&&"object"!=typeof a.events)throw Error(`Element "${t}": Events must be an object`);if(a.alpine&&"object"!=typeof a.alpine)throw Error(`Element "${t}": Alpine must be an object`)}return!0}catch(e){return e instanceof Error&&e.message,!1}}loadCustomRegistry(e){if(!t.validateRegistry(e))throw Error("Invalid registry configuration");this.elements.clear();for(const t of Object.values(e))this.register(t)}toJSON(){const e={};for(const[t,a]of this.elements)e[t]=a;return e}}t.STANDARD_META={label:{type:"text",label:"Label",defaultValue:"Field",required:!0},hint:{type:"text",label:"Hint",defaultValue:""},helperText:{type:"textarea",label:"Helper Text",defaultValue:""},icon:{type:"text",label:"Icon",defaultValue:"üìù"},wrapperClasses:{type:"css-classes",label:"CSS Classes",defaultValue:[]},validation:{type:"textarea",label:"Validation Rules",defaultValue:"",description:"JSON validation rules"}},t.STANDARD_EVENTS={onChange:{type:"event",label:"On Change (change)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onInput:{type:"event",label:"On Input (input)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onFocus:{type:"event",label:"On Focus (focus)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onBlur:{type:"event",label:"On Blur (blur)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onClick:{type:"event",label:"On Click (click)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onKeyDown:{type:"event",label:"On Key Down (keydown)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onKeyUp:{type:"event",label:"On Key Up (keyup)",defaultValue:{action:"",target:"vanilla",parameters:{}}},onSubmit:{type:"event",label:"On Submit (submit)",defaultValue:{action:"",target:"vanilla",parameters:{}}}},t.STANDARD_ALPINE={"x-model":{type:"alpine",label:"x-model",defaultValue:""},"x-data":{type:"alpine",label:"x-data",defaultValue:""},"x-show":{type:"alpine",label:"x-show",defaultValue:""},"x-if":{type:"alpine",label:"x-if",defaultValue:""}};class a{constructor(){this.events=new Map}on(e,t){this.events.has(e)||this.events.set(e,[]),this.events.get(e).push(t)}off(e,t){const a=this.events.get(e);if(a){const e=a.indexOf(t);e>-1&&a.splice(e,1)}}emit(e,t){const a=this.events.get(e);a&&a.forEach(e=>e(t))}}class l{static generateId(){return"element_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}static createElement(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstElementChild}static debounce(e,t){let a;return(...l)=>{clearTimeout(a),a=window.setTimeout(()=>e.apply(this,l),t)}}static deepClone(e){return JSON.parse(JSON.stringify(e))}static formatDate(e){return e.toISOString()}}class i extends a{constructor(e){super(),this.container=e,this.currentElement=null,this.currentConfig=null,this.currentElementType=null}canHaveExtendedProperties(e,t){return"row"!==this.currentElementType&&"column"!==this.currentElementType&&("form"===this.currentElementType||"field"===this.currentElementType||t&&("form"===t.category||"content"===t.category))}showProperties(e,t,a){this.currentElement=e,this.currentConfig=t,this.currentElementType=a,this.render()}hideProperties(){this.currentElement=null,this.currentConfig=null,this.container.innerHTML='<p class="no-selection">Select an element to edit its properties</p>'}render(){if(!this.currentElement||!this.currentConfig)return void this.hideProperties();const e=`\n            <div class="properties-content">\n                <div class="property-group">\n                    <div class="element-header-with-delete">\n                        <h4>Element: ${this.currentConfig.label}</h4>\n                        <button type="button" class="btn-delete-element" id="deleteElement" title="Delete Element">\n                            üóëÔ∏è\n                        </button>\n                    </div>\n                </div>\n                \n                ${this.renderGroupedProperties()}\n            </div>\n        `;this.container.innerHTML=e,this.attachEventListeners()}renderGroupedProperties(){return this.currentConfig&&this.currentElement?[{key:"properties",label:"Properties",icon:"‚öôÔ∏è",config:this.currentConfig.properties||{}},{key:"meta",label:"Meta",icon:"üìã",config:this.currentConfig.meta||{}},{key:"events",label:"Events",icon:"‚ö°",config:this.currentConfig.events||{}},{key:"alpine",label:"Alpine",icon:"üèîÔ∏è",config:this.currentConfig.alpine||{}}].filter(e=>Object.keys(e.config).length>0).map(e=>this.renderPropertyGroup(e.key,e.label,e.icon,e.config)).join(""):""}renderPropertyGroup(e,t,a,l){const i="group-"+e,r=Object.entries(l).map(([t,a])=>this.renderPropertyField(t,a,e)).join("");return`\n            <div class="property-group">\n                <div class="group-header" data-group="${e}">\n                    <span class="group-icon">${a}</span>\n                    <span class="group-title">${t}</span>\n                    <span class="group-toggle">‚ñº</span>\n                </div>\n                <div class="group-content" id="${i}">\n                    ${r}\n                </div>\n            </div>\n        `}getPropertyValue(e,t,a){if(!this.currentElement||!this.currentConfig)return a.defaultValue??"";let l;switch(t){case"properties":default:l=this.currentElement.properties;break;case"meta":this.canHaveExtendedProperties(this.currentElement,this.currentConfig)&&(l=this.currentElement.meta);break;case"events":this.canHaveExtendedProperties(this.currentElement,this.currentConfig)&&(l=this.currentElement.events);break;case"alpine":this.canHaveExtendedProperties(this.currentElement,this.currentConfig)&&(l=this.currentElement.alpine)}return l?.[e]??a.defaultValue??""}renderProperties(){return this.currentConfig&&this.currentElement?Object.entries(this.currentConfig.properties||{}).map(([e,t])=>this.renderPropertyField(e,t,"properties")).join(""):""}renderPropertyField(e,t,a="properties"){const l=this.getPropertyValue(e,a,t),i=`prop_${a}_${e}`;let r="";switch(t.type){case"text":default:r=`<input type="text" id="${i}" value="${this.escapeHtml(l)}" />`;break;case"textarea":r=`<textarea id="${i}" rows="3">${this.escapeHtml(l)}</textarea>`;break;case"number":r=`<input type="number" id="${i}" value="${l}" />`;break;case"boolean":r=`\n                    <label class="switch">\n                        <input type="checkbox" id="${i}" ${l?"checked":""} />\n                        <span class="slider"></span>\n                    </label>\n                `;break;case"select":r=`<select id="${i}">${(t.options||[]).map(e=>`<option value="${this.escapeHtml(e.value)}" ${e.value===l?"selected":""}>${this.escapeHtml(e.label)}</option>`).join("")}</select>`;break;case"color":r=`<input type="color" id="${i}" value="${l}" />`;break;case"event":const e="object"==typeof l?l:{action:"",target:"vanilla",parameters:{}};r=`\n                    <div class="event-config">\n                        <input type="text" id="${i}_action" placeholder="Action" value="${this.escapeHtml(e.action||"")}" />\n                        <select id="${i}_target">\n                            <option value="vanilla" ${"vanilla"===e.target?"selected":""}>Vanilla JS</option>\n                            <option value="alpine" ${"alpine"===e.target?"selected":""}>Alpine.js</option>\n                            <option value="livewire" ${"livewire"===e.target?"selected":""}>Livewire</option>\n                        </select>\n                    </div>\n                `;break;case"alpine":r=`<input type="text" id="${i}" value="${this.escapeHtml(l)}" placeholder="Alpine.js directive" />`;break;case"css-classes":const a=Array.isArray(l)?l.join(" "):(l||"")+"";r=`<input type="text" id="${i}" value="${this.escapeHtml(a)}" placeholder="CSS classes" />`;break;case"fixed":r=`<input type="text" id="${i}" value="${this.escapeHtml(l)}" readonly />`}return`\n            <div class="property-field">\n                <label for="${i}">${t.required?`<strong>${t.label} <span style="color: #e74c3c;">*</span></strong>`:t.label}</label>\n                <div class="property-value">\n                    ${r}\n                </div>\n                ${t.description?`<small>${t.description}</small>`:""}\n            </div>\n        `}attachEventListeners(){if(!this.currentConfig||!this.currentElement)return;this.container.querySelectorAll(".group-header").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.dataset.group;t&&this.toggleGroup(t)})}),["properties","meta","events","alpine"].forEach(e=>{const t=this.getGroupConfig(e);t&&Object.keys(t).forEach(a=>{const i=t[a];if("fixed"===i.type)return;const r=this.container.querySelector(`#prop_${e}_${a}`);if(r){const t=l.debounce(()=>{this.updateProperty(a,this.getInputValue(r),e)},150);r.addEventListener("input",t),r.addEventListener("change",()=>{this.updateProperty(a,this.getInputValue(r),e)})}if("event"===i.type){const t=this.container.querySelector(`#prop_${e}_${a}_action`),i=this.container.querySelector(`#prop_${e}_${a}_target`);if(t&&i){const r=()=>{const l={action:t.value,target:i.value,parameters:{}};this.updateProperty(a,l,e)};t.addEventListener("input",l.debounce(r,150)),t.addEventListener("change",r),i.addEventListener("change",r)}}})});const e=this.container.querySelector("#deleteElement");e&&e.addEventListener("click",()=>{this.currentElement&&(this.emit("deleteElement",{elementId:this.currentElement.id}),this.hideProperties())})}toggleGroup(e){const t=this.container.querySelector("#group-"+e),a=this.container.querySelector(`[data-group="${e}"] .group-toggle`);if(t&&a){const e="none"!==t.style.display;t.style.display=e?"none":"block",a.textContent=e?"‚ñ∂":"‚ñº"}}getGroupConfig(e){if(!this.currentConfig)return null;switch(e){case"properties":return this.currentConfig.properties||{};case"meta":return this.currentConfig.meta||{};case"events":return this.currentConfig.events||{};case"alpine":return this.currentConfig.alpine||{};default:return null}}getInputValue(e){switch(e.type){case"checkbox":return e.checked;case"number":return parseFloat(e.value)||0;default:return e.value}}updateProperty(e,t,a="properties"){if(!this.currentElement||!this.currentConfig)return;let l;switch(a){case"properties":default:this.currentElement.properties||(this.currentElement.properties={}),l=this.currentElement.properties;break;case"meta":if(!this.canHaveExtendedProperties(this.currentElement,this.currentConfig))return;{const e=this.currentElement;e.meta||(e.meta={}),l=e.meta}break;case"events":if(!this.canHaveExtendedProperties(this.currentElement,this.currentConfig))return;{const e=this.currentElement;e.events||(e.events={}),l=e.events}break;case"alpine":if(!this.canHaveExtendedProperties(this.currentElement,this.currentConfig))return;{const e=this.currentElement;e.alpine||(e.alpine={}),l=e.alpine}}l[e]=t,this.emit("propertyChanged",{elementId:this.currentElement.id,property:e,value:t,element:this.currentElement,section:a})}escapeHtml(e){return"string"!=typeof e&&(e=(e||"")+""),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}getCurrentElement(){return this.currentElement}}class r extends a{constructor(e,t){super(),this.container=e,this.scopedDOM=t,this.draggedData=null,setTimeout(()=>{this.initializeDragAndDrop()},100)}initializeDragAndDrop(){this.setupDropZones()}setupDropZones(){const e=(e,t)=>{this.scopedDOM?this.scopedDOM.addEventListener(e,t):this.container.addEventListener(e,t)};e("dragstart",e=>{const t=e,a=t.target;!this.scopedDOM||this.scopedDOM.validateOperation(a,"dragstart")?this.handleDragStart(t,a):t.preventDefault()}),e("dragover",e=>{const t=e,a=t.target;this.scopedDOM&&!this.scopedDOM.validateOperation(a,"dragover")||this.handleDragOver(t,a)}),e("dragleave",e=>{const t=e,a=t.target;this.scopedDOM&&!this.scopedDOM.validateOperation(a,"dragleave")||this.handleDragLeave(t,a)}),e("drop",e=>{const t=e,a=t.target;this.scopedDOM&&!this.scopedDOM.validateOperation(a,"drop")||this.handleDrop(t,a)}),e("dragend",e=>{const t=e,a=t.target;this.scopedDOM&&!this.scopedDOM.validateOperation(a,"dragend")||this.handleDragEnd(t,a)})}handleDragStart(e,t){const a=t.closest(".element-item");if(a){const t=a.dataset.elementType;if(t)return this.draggedData={elementType:t,isNew:!0,sourceType:"toolbox"},this.emit("dragStart",this.draggedData),void(e.dataTransfer&&(e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("text/plain",t),e.dataTransfer.setData("application/x-drag-source","sidebar")))}const l=t.closest(".drag-handle-btn");if(l){const t=l.dataset.elementId,a=l.dataset.elementType;if(t&&a)return this.draggedData={elementType:a,elementId:t,isNew:!1,sourceType:a},this.emit("dragStart",this.draggedData),void(e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/x-element-id",t),e.dataTransfer.setData("application/x-element-type",a),e.dataTransfer.setData("application/x-drag-source","internal")))}const i=t.closest(".form-element");if(i){const t=i.dataset.elementId,a=i.dataset.elementType;t&&a&&(this.draggedData={elementType:a,elementId:t,isNew:!1,sourceType:"field"},this.emit("dragStart",this.draggedData),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/x-element-id",t),e.dataTransfer.setData("application/x-element-type",a),e.dataTransfer.setData("application/x-drag-source","internal")))}}handleDragOver(e,t){e.preventDefault();const a=t.closest(".drop-zone");a&&this.draggedData&&(a.classList.add("drag-over"),e.dataTransfer&&(e.dataTransfer.dropEffect=this.draggedData.isNew?"copy":"move"))}handleDragLeave(e,t){const a=t.closest(".drop-zone");if(a){const t=a.getBoundingClientRect(),l=e.clientX,i=e.clientY;(l<t.left||l>t.right||i<t.top||i>t.bottom)&&a.classList.remove("drag-over")}}handleDrop(e,t){e.preventDefault();const a=t.closest(".drop-zone");a&&a.classList.remove("drag-over"),this.draggedData&&this.emit("elementDropped",{data:this.draggedData,dropTarget:t,event:e}),this.clearDraggedData()}handleDragEnd(e,t){(this.scopedDOM?.getContainer()||this.container).querySelectorAll(".drag-over").forEach(e=>{e.classList.remove("drag-over")}),this.clearDraggedData()}clearDraggedData(){this.draggedData=null}getDraggedData(){return this.draggedData}setDraggedData(e){this.draggedData=e}isDragging(){return null!==this.draggedData}reset(){this.clearDraggedData(),(this.scopedDOM?.getContainer()||this.container).querySelectorAll(".drag-over, .dragging").forEach(e=>{e.classList.remove("drag-over","dragging")})}refresh(){}}class n{static export(e,t){const a=new Date;return{version:this.VERSION,rows:l.deepClone(e),metadata:{created:t?.created||l.formatDate(a),modified:l.formatDate(a),title:t?.title,description:t?.description}}}static import(e){let t;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){throw Error("Invalid JSON format")}else t=e;if("formElement"in t||"metadata"in t&&!("version"in t)){const e=t;if(!Array.isArray(e.rows))throw Error("Invalid form data structure: rows must be an array");return e.rows.forEach((e,t)=>{if(!e.id||!Array.isArray(e.columns))throw Error(`Invalid row at index ${t}: missing required fields`);e.columns.forEach((e,a)=>{if(!e.id||"number"!=typeof e.width||!Array.isArray(e.fields))throw Error(`Invalid column at row ${t}, column ${a}: missing required fields`)})}),l.deepClone(e)}const a=t;if(!a.version||!Array.isArray(a.rows))throw Error("Invalid form data structure");return a.version,this.VERSION,a.rows.forEach((e,t)=>{if(!e.id||!Array.isArray(e.columns))throw Error(`Invalid row at index ${t}: missing required fields`);e.columns.forEach((e,a)=>{if(!e.id||"number"!=typeof e.width||!Array.isArray(e.fields))throw Error(`Invalid column at row ${t}, column ${a}: missing required fields`)})}),l.deepClone(a.rows)}static download(e,t="form-layout.json",a){const l=this.export(e,a),i=JSON.stringify(l,null,2),r=new Blob([i],{type:"application/json"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download=t,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}static upload(){return new Promise((e,t)=>{const a=document.createElement("input");a.type="file",a.accept=".json",a.style.display="none",a.addEventListener("change",a=>{const l=a.target.files?.[0];if(!l)return void t(Error("No file selected"));const i=new FileReader;i.onload=a=>{try{const t=a.target?.result,l=this.import(t);e(l)}catch(e){t(e)}},i.onerror=()=>{t(Error("Failed to read file"))},i.readAsText(l)}),document.body.appendChild(a),a.click(),document.body.removeChild(a)})}static validate(e){if(!e||"object"!=typeof e)return!1;if(!e.version||"string"!=typeof e.version)return!1;if(!Array.isArray(e.rows))return!1;if(!e.metadata||"object"!=typeof e.metadata)return!1;for(const t of e.rows){if(!t.id||!Array.isArray(t.columns))return!1;for(const e of t.columns){if(!e.id||"number"!=typeof e.width||!Array.isArray(e.fields))return!1;for(const t of e.fields){if(!t.id||!t.type||!t.properties)return!1;if("string"!=typeof t.id||"string"!=typeof t.type)return!1;if("object"!=typeof t.properties)return!1}}}return!0}static createPreview(e){if(0===e.length)return"Empty form";let t=0,a=0;e.forEach(e=>{a+=e.columns.length,e.columns.forEach(e=>{t+=e.fields.length})});const l=[];return e.length>0&&l.push(`${e.length} row${e.length>1?"s":""}`),a>0&&l.push(`${a} column${a>1?"s":""}`),t>0&&l.push(`${t} field${t>1?"s":""}`),l.join(", ")}}n.VERSION="0.1.0";class s{escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}formatAttributes(e){return Object.entries(e).filter(([e,t])=>null!=t&&""!==t).map(([e,t])=>`${e}="${this.escapeHtml(t+"")}"`).join(" ")}getFieldLabel(e){return e.meta?.label||e.properties?.label||""}getFieldName(e){return e.properties?.name||e.properties?.id||""}getFieldId(e){return e.properties?.id||""}}const o=["input","textarea","select","button"],d=["div","section","fieldset","form"],u=["h1","h2","h3","h4","h5","h6","p","span","hr"],c=["img","video","audio"],h={"text-input":"text",text:"text","input-text":"text","email-input":"email",email:"email","password-input":"password",password:"password","number-input":"number",number:"number","url-input":"url",url:"url","tel-input":"tel",tel:"tel"},p={text:"Enter text...","text-input":"Enter text...","input-text":"Enter text...",email:"Enter email...","email-input":"Enter email...",password:"Enter password...","password-input":"Enter password...",number:"Enter number...","number-input":"Enter number...",url:"Enter URL...","url-input":"Enter URL...",tel:"Enter phone...","tel-input":"Enter phone...",textarea:"Enter text...",select:"Select an option..."};class m{static isFormControl(e){return o.includes(e)}static isLayoutElement(e){return d.includes(e)}static isContentElement(e){return u.includes(e)}static isMediaElement(e){return c.includes(e)}static supportsMetaLabel(e){return m.isFormControl(e)}static supportsValidation(e){return m.isFormControl(e)&&"button"!==e}static supportsPlaceholder(e){return["text","text-input","input-text","email","email-input","password","password-input","number","number-input","url","url-input","tel","tel-input","textarea"].includes(e)}static supportsOptions(e){return["select","radio","radio-group","checkbox-group"].includes(e)}static getHtmlInputType(e){return h[e]||"text"}static getDefaultPlaceholder(e){return p[e]||""}static getElementCategory(e){return m.isFormControl(e)?"form":m.isLayoutElement(e)?"layout":m.isContentElement(e)?"content":m.isMediaElement(e)?"media":"other"}static isValidElementType(e){return m.isFormControl(e)||m.isLayoutElement(e)||m.isContentElement(e)||m.isMediaElement(e)}static getAllFormControlTags(){return o}static getAllLayoutElementTags(){return d}static requiresNameAttribute(e){return m.isFormControl(e)&&"button"!==e}static canBeRequired(e){return m.supportsValidation(e)}}class b extends s{renderField(e,t={}){const{includeLabels:a=!0,includeWrapper:l=!0}=t;let i="";if(l&&(i+='<div class="preview-field">\n'),a&&e.meta?.label&&this.isFormControl(e.htmlTag)){const t=e.properties.required;i+='  <div class="field-preview-label">',i+=this.escapeHtml(e.meta.label),t&&(i+=' <span class="required">*</span>'),i+="</div>\n"}switch(e.htmlTag){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"p":case"span":case"pre":case"code":case"blockquote":case"div":const t=e.meta?.innerHTML||e.htmlTag.toUpperCase()+" Content";i+=`  <${e.htmlTag} class="field-preview-content">${this.escapeHtml(t)}</${e.htmlTag}>\n`;break;case"hr":i+='  <hr class="field-preview-content" />\n';break;case"img":const a=e.properties?.src||"https://via.placeholder.com/300x200",l=e.properties?.alt||"Image";i+=`  <img src="${this.escapeHtml(a)}" alt="${this.escapeHtml(l)}" class="field-preview-media" style="max-width: 100%; height: auto;" />\n`;break;case"video":const r=e.properties?.src||"";r?(i+='  <video controls class="field-preview-media" style="max-width: 100%; height: auto;">\n',i+=`    <source src="${this.escapeHtml(r)}" />\n`,i+="    Your browser does not support the video tag.\n",i+="  </video>\n"):i+='  <div class="field-preview-placeholder">üé• Video (no source specified)</div>\n';break;case"audio":const n=e.properties?.src||"";n?(i+='  <audio controls class="field-preview-media">\n',i+=`    <source src="${this.escapeHtml(n)}" />\n`,i+="    Your browser does not support the audio tag.\n",i+="  </audio>\n"):i+='  <div class="field-preview-placeholder">üéµ Audio (no source specified)</div>\n';break;case"input":switch(e.properties.type){case"text":case"email":case"password":case"number":case"url":case"tel":i+=`  <input type="${e.properties.type}" class="field-preview-input" placeholder="${e.properties.placeholder||""}" disabled />\n`;break;case"radio":const t=this.parseSelectOptions(e.properties?.options||"");if(t.length>0){i+='  <div class="field-preview-radio-group">\n';for(let a=0;a<t.length;a++){const l=t[a];l&&(i+=`    <label class="field-preview-radio"><input type="radio" name="${e.properties.name||e.id}_preview" disabled /> ${this.escapeHtml(l.label)}</label>\n`)}i+="  </div>\n"}else i+='  <div class="field-preview-radio-group">\n',i+='    <label class="field-preview-radio"><input type="radio" disabled /> Option 1</label>\n',i+="  </div>\n";break;case"submit":case"reset":const a=e.meta.label||e.properties.value||e.properties.type.charAt(0).toUpperCase()+e.properties.type.slice(1);i+=`  <input type="${e.properties.type}" class="field-preview-button field-preview-button-secondary" value="${this.escapeHtml(a)}" disabled />\n`;break;default:i+=`  <div class="field-preview-placeholder">üîß ${e.htmlTag} = ${e.properties.type}</div>\n`}break;case"button":const s=e.meta.label||e.properties.label||"Button",o=e.properties.type||"button";let d="field-preview-button";switch(e.properties.type){case"button":case"submit":case"reset":d+=" field-preview-button-secondary",i+=`  <button type="${o}" class="${d}" disabled>${this.escapeHtml(s)}</button>\n`;break;default:i+=`  <div class="field-preview-placeholder">üîß ${e.htmlTag} = ${e.properties.type}</div>\n`}break;case"textarea":i+=`  <textarea class="field-preview-textarea" placeholder="${e.properties.placeholder||""}" disabled></textarea>\n`;break;case"select":i+='  <select class="field-preview-select" disabled>\n';const u=this.parseSelectOptions(e.properties?.options||"");if(0===u.length)i+='    <option value="">Select an option...</option>\n';else for(const e of u)i+=`    <option value="${this.escapeHtml(e.value)}">${this.escapeHtml(e.label)}</option>\n`;i+="  </select>\n";break;case"checkbox":const c=e.meta.label||e.properties.label||"Checkbox";i+=`  <label class="field-preview-checkbox"><input type="checkbox" disabled /> ${this.escapeHtml(c)}</label>\n`;break;default:i+=`  <div class="field-preview-placeholder">üîß ${e.htmlTag}</div>\n`}return e.meta&&e.meta.helperText&&(i+=`  <div class="preview-help">${this.escapeHtml(e.meta.helperText)}</div>\n`),l&&(i+="</div>\n"),i}renderColumn(e,t={}){let a=`<div class="preview-column" data-width="${e.width||12}">\n`;if(e.fields&&Array.isArray(e.fields))for(const l of e.fields)a+=this.renderField(l,t);return e.fields&&0!==e.fields.length||(a+='  <div class="preview-column-placeholder">Drop fields here</div>\n'),a+="</div>\n",a}renderRow(e,t={}){let a='<div class="preview-row">\n';if(e.columns&&Array.isArray(e.columns))for(const l of e.columns)a+=this.renderColumn(l,t);return e.columns&&0!==e.columns.length||(a+='  <div class="preview-row-placeholder">Drop columns here</div>\n'),a+="</div>\n",a}renderForm(e,t={}){let a='<div class="preview-form">\n';if(0===e.length)a+='  <div class="preview-empty">\n',a+='    <div class="preview-empty-icon">üìù</div>\n',a+='    <div class="preview-empty-text">Start building your form</div>\n',a+='    <div class="preview-empty-hint">Drag elements from the toolbox to create your form</div>\n',a+="  </div>\n";else for(const l of e)a+=this.renderRow(l,t);return a+="</div>\n",a}renderPreview(e,t={}){return this.renderForm(e,t)}isFormControl(e){return m.isFormControl(e)}parseSelectOptions(e){return e?e.split("\n").filter(e=>e.trim()).map(e=>{const t=e.trim();if(t.includes("|")){const[e,a]=t.split("|",2);return{label:e?.trim()||"",value:a?.trim()||""}}return{label:t,value:t}}):[]}}class f extends s{renderField(e,t={}){const{includeLabels:a=!0}=t,l=this.getFieldId(e);this.getFieldName(e);const i=this.getFieldLabel(e);let r="";switch(a&&i&&(r+=`<label for="${l}">${this.escapeHtml(i)}</label>\n`),e.htmlTag){case"input":r+=this.renderInput(e);break;case"textarea":r+=this.renderTextarea(e);break;case"select":r+=this.renderSelect(e);break;case"button":r+=this.renderButton(e);break;case"checkbox":r+=this.renderCheckbox(e);break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":r+=this.renderHeading(e);break;case"p":r+=this.renderParagraph(e);break;case"div":r+=this.renderDiv(e);break;case"span":r+=this.renderSpan(e);break;case"a":r+=this.renderLink(e);break;case"pre":r+=this.renderPreformatted(e);break;case"code":r+=this.renderCode(e);break;case"hr":r+=this.renderHorizontalRule(e);break;case"br":r+=this.renderLineBreak(e);break;case"img":r+=this.renderImage(e);break;default:r+=`\x3c!-- Unknown field type: ${e.htmlTag} --\x3e`}return r}renderInput(e){const t={type:e.properties?.type||"text",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",value:e.properties?.value||"",required:e.properties?.required?"required":void 0,maxlength:e.properties?.maxLength||void 0,minlength:e.properties?.minLength||void 0,min:e.properties?.min||void 0,max:e.properties?.max||void 0,step:e.properties?.step||void 0,pattern:e.properties?.pattern||void 0,class:e.properties?.class||void 0,style:e.properties?.style||void 0,checked:e.properties?.checked?"checked":void 0,multiple:e.properties?.multiple?"multiple":void 0,accept:e.properties?.accept||void 0};return`<input ${this.formatAttributes(t)} />`}renderTextInput(e){const t={type:e.properties?.type||"text",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",value:e.properties?.value||"",required:e.properties?.required?"required":void 0,maxlength:e.properties?.maxLength||void 0};return`<input ${this.formatAttributes(t)} />`}renderEmailInput(e){const t={type:"email",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",value:e.properties?.value||"",required:e.properties?.required?"required":void 0};return`<input ${this.formatAttributes(t)} />`}renderPasswordInput(e){const t={type:"password",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",required:e.properties?.required?"required":void 0};return`<input ${this.formatAttributes(t)} />`}renderNumberInput(e){const t={type:"number",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",value:e.properties?.value||"",min:e.properties?.min||void 0,max:e.properties?.max||void 0,required:e.properties?.required?"required":void 0};return`<input ${this.formatAttributes(t)} />`}renderTextarea(e){const t={id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",rows:e.properties?.rows||4,required:e.properties?.required?"required":void 0},a=this.escapeHtml(e.properties?.value||"");return`<textarea ${this.formatAttributes(t)}>${a}</textarea>`}renderSelect(e){const t={id:this.getFieldId(e),name:this.getFieldName(e),required:e.properties?.required?"required":void 0,multiple:e.properties?.multiple?"multiple":void 0};let a=`<select ${this.formatAttributes(t)}>\n`;return this.parseSelectOptions(e.properties?.options||"").forEach(t=>{const l=t.value===e.properties?.value?"selected":"";a+=`  <option value="${this.escapeHtml(t.value)}" ${l}>${this.escapeHtml(t.label)}</option>\n`}),a+="</select>",a}renderCheckbox(e){const t={type:"checkbox",id:this.getFieldId(e),name:this.getFieldName(e),value:e.properties?.value||"1",checked:e.properties?.checked?"checked":void 0};return`<input ${this.formatAttributes(t)} />`}renderRadio(e){const t={type:"radio",id:this.getFieldId(e),name:this.getFieldName(e),value:e.properties?.value||"",checked:e.properties?.checked?"checked":void 0};return`<input ${this.formatAttributes(t)} />`}renderButton(e){const t={type:e.properties?.type||"button",id:this.getFieldId(e),name:this.getFieldName(e)},a=this.getFieldLabel(e)||e.properties?.value||"Button";return`<button ${this.formatAttributes(t)}>${this.escapeHtml(a)}</button>`}renderHeading(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"Heading",l=e.htmlTag||"h1";return`<${l} ${this.formatAttributes(t)}>${this.escapeHtml(a)}</${l}>`}renderParagraph(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"Paragraph text";return`<p ${this.formatAttributes(t)}>${this.escapeHtml(a)}</p>`}renderDiv(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"";return`<div ${this.formatAttributes(t)}>${this.escapeHtml(a)}</div>`}renderSpan(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"";return`<span ${this.formatAttributes(t)}>${this.escapeHtml(a)}</span>`}renderLink(e){const t={id:this.getFieldId(e),href:e.properties?.href||"#",target:e.properties?.target||void 0,class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"Link";return`<a ${this.formatAttributes(t)}>${this.escapeHtml(a)}</a>`}renderPreformatted(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"";return`<pre ${this.formatAttributes(t)}>${this.escapeHtml(a)}</pre>`}renderCode(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0},a=e.meta?.innerHTML||e.meta?.label||"";return`<code ${this.formatAttributes(t)}>${this.escapeHtml(a)}</code>`}renderHorizontalRule(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<hr ${this.formatAttributes(t)} />`}renderLineBreak(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0};return`<br ${this.formatAttributes(t)} />`}renderImage(e){const t={id:this.getFieldId(e),src:e.properties?.src||"",alt:e.properties?.alt||"",width:e.properties?.width||void 0,height:e.properties?.height||void 0,title:e.properties?.title||void 0,loading:e.properties?.loading||void 0,decoding:e.properties?.decoding||void 0,crossorigin:e.properties?.crossorigin||void 0,referrerpolicy:e.properties?.referrerpolicy||void 0,sizes:e.properties?.sizes||void 0,srcset:e.properties?.srcset||void 0,class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<img ${this.formatAttributes(t)} />`}parseSelectOptions(e){return e?e.split("\n").filter(e=>e.trim()).map(e=>{const t=e.trim();if(t.includes("|")){const[e,a]=t.split("|",2);return{label:e?.trim()||"",value:a?.trim()||""}}return{label:t,value:t}}):[]}renderColumn(e,t={}){const{includeWrapper:a=!0}=t;let l="";return a&&(l+=`<div class="column" data-width="${e.width}">\n`),e.fields.forEach(e=>{l+='  <div class="field">\n',l+=`    ${this.renderField(e,t)}\n`,l+="  </div>\n"}),a&&(l+="</div>\n"),l}renderRow(e,t={}){const{includeWrapper:a=!0}=t;let l="";return a&&(l+=`<div class="row" id="${e.id}">\n`),e.columns.forEach(e=>{l+=this.renderColumn(e,t)}),a&&(l+="</div>\n"),l}renderForm(e,t={}){const{formId:a="generated-form",formAction:l="",formMethod:i="POST",cssFile:r="basic.css"}=t;let n=`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Generated Form</title>\n    <link rel="stylesheet" href="${r}">\n</head>\n<body>\n    <form id="${a}" action="${l}" method="${i}">\n`;return e.forEach(e=>{n+=this.renderRow(e,t)}),n+="    </form>\n</body>\n</html>",n}renderPreview(e,t={}){const{cssFile:a="preview.css"}=t;let l=`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Form Preview</title>\n    <link rel="stylesheet" href="${a}">\n</head>\n<body>\n    <div class="preview-container">\n        <h2>Form Preview</h2>\n        <div class="preview-form">\n`;return e.forEach(e=>{l+=this.renderRow(e,{...t,includeWrapper:!0})}),l+="        </div>\n    </div>\n</body>\n</html>",l}}class y extends s{renderField(e,t={}){const{includeLabels:a=!0}=t,l=this.getFieldId(e),i=this.getFieldLabel(e);let r="";if(r+='<div class="mb-3">\n',a&&i){const t=e.properties?.required?' <span class="text-danger">*</span>':"";r+=`  <label for="${l}" class="form-label">${this.escapeHtml(i)}${t}</label>\n`}switch(e.htmlTag){case"input":switch(e.properties.type){case"text":case"email":case"password":case"number":case"url":case"tel":r+=`  ${this.renderTextInput(e)}\n`;break;case"radio":r+=`  ${this.renderRadio(e)}\n`;break;case"submit":case"reset":r+=`  ${this.renderButton(e)}\n`;break;default:r+=`  \x3c!-- Unknown input type: ${e.properties.type} --\x3e\n`}break;case"textarea":r+=`  ${this.renderTextarea(e)}\n`;break;case"select":r+=`  ${this.renderSelect(e)}\n`;break;case"checkbox":r+=`  ${this.renderCheckbox(e)}\n`;break;case"button":r+=`  ${this.renderButton(e)}\n`;break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":r+=`  ${this.renderHeading(e)}\n`;break;case"p":r+=`  ${this.renderParagraph(e)}\n`;break;case"div":r+=`  ${this.renderDiv(e)}\n`;break;case"span":r+=`  ${this.renderSpan(e)}\n`;break;case"a":r+=`  ${this.renderLink(e)}\n`;break;case"pre":r+=`  ${this.renderPreformatted(e)}\n`;break;case"code":r+=`  ${this.renderCode(e)}\n`;break;case"hr":r+=`  ${this.renderHorizontalRule(e)}\n`;break;case"br":r+=`  ${this.renderLineBreak(e)}\n`;break;case"img":r+=`  ${this.renderImage(e)}\n`;break;default:r+=`  \x3c!-- Unknown field htmlTag: ${e.htmlTag} --\x3e\n`}const n=e.meta?.helperText||e.meta?.hint;return n&&(r+=`  <div class="form-text">${this.escapeHtml(n)}</div>\n`),r+="</div>\n",r}renderTextInput(e){const t={type:e.properties?.type||"text",class:"form-control",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",value:e.properties?.value||"",required:e.properties?.required?"required":void 0,maxlength:e.properties?.maxLength||void 0};return`<input ${this.formatAttributes(t)} />`}renderTextarea(e){const t={class:"form-control",id:this.getFieldId(e),name:this.getFieldName(e),placeholder:e.properties?.placeholder||"",rows:e.properties?.rows||4,required:e.properties?.required?"required":void 0},a=this.escapeHtml(e.properties?.value||"");return`<textarea ${this.formatAttributes(t)}>${a}</textarea>`}renderSelect(e){const t={class:"form-select",id:this.getFieldId(e),name:this.getFieldName(e),required:e.properties?.required?"required":void 0,multiple:e.properties?.multiple?"multiple":void 0};let a=`<select ${this.formatAttributes(t)}>\n`;return e.properties?.required||(a+='    <option value="">Choose...</option>\n'),this.parseSelectOptions(e.properties?.options||"").forEach(t=>{const l=t.value===e.properties?.value?"selected":"";a+=`    <option value="${this.escapeHtml(t.value)}" ${l}>${this.escapeHtml(t.label)}</option>\n`}),a+="  </select>",a}renderCheckbox(e){const t=this.getFieldId(e),a=this.getFieldLabel(e),l={type:"checkbox",class:"form-check-input",id:t,name:this.getFieldName(e),value:e.properties?.value||"1",checked:e.properties?.checked?"checked":void 0};let i='<div class="form-check">\n';return i+=`    <input ${this.formatAttributes(l)} />\n`,a&&(i+=`    <label class="form-check-label" for="${t}">${this.escapeHtml(a)}</label>\n`),i+="  </div>",i}renderRadio(e){const t=this.getFieldId(e),a=this.getFieldLabel(e),l={type:"radio",class:"form-check-input",id:t,name:this.getFieldName(e),value:e.properties?.value||"",checked:e.properties?.checked?"checked":void 0};let i='<div class="form-check">\n';return i+=`    <input ${this.formatAttributes(l)} />\n`,a&&(i+=`    <label class="form-check-label" for="${t}">${this.escapeHtml(a)}</label>\n`),i+="  </div>",i}renderButton(e){const t={type:e.properties?.type||"button",class:"btn btn-primary",id:this.getFieldId(e),name:this.getFieldName(e)},a=this.getFieldLabel(e)||e.properties?.value||"Button";return`<button ${this.formatAttributes(t)}>${this.escapeHtml(a)}</button>`}parseSelectOptions(e){return e?e.split("\n").filter(e=>e.trim()).map(e=>{const t=e.trim();if(t.includes("|")){const[e,a]=t.split("|",2);return{label:e?.trim()||"",value:a?.trim()||""}}return{label:t,value:t}}):[]}renderHeading(e){const t=e.meta?.innerHTML||e.meta?.label||"Heading",a=e.htmlTag||"h1",l={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<${a} ${this.formatAttributes(l)}>${this.escapeHtml(t)}</${a}>`}renderParagraph(e){const t=e.meta?.innerHTML||e.meta?.label||"Paragraph text",a={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<p ${this.formatAttributes(a)}>${this.escapeHtml(t)}</p>`}renderDiv(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<div ${this.formatAttributes(a)}>${this.escapeHtml(t)}</div>`}renderSpan(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<span ${this.formatAttributes(a)}>${this.escapeHtml(t)}</span>`}renderLink(e){const t=e.meta?.innerHTML||e.meta?.label||"Link",a={id:this.getFieldId(e),href:e.properties?.href||"#",target:e.properties?.target||void 0,class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<a ${this.formatAttributes(a)}>${this.escapeHtml(t)}</a>`}renderPreformatted(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<pre ${this.formatAttributes(a)}>${this.escapeHtml(t)}</pre>`}renderCode(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||"language-javascript",style:e.properties?.style||void 0};return`<code ${this.formatAttributes(a)}>${this.escapeHtml(t)}</code>`}renderHorizontalRule(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<hr ${this.formatAttributes(t)} />`}renderLineBreak(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0};return`<br ${this.formatAttributes(t)} />`}renderImage(e){const t={id:this.getFieldId(e),src:e.properties?.src||"",alt:e.properties?.alt||"",class:e.properties?.class||"img-fluid",width:e.properties?.width||void 0,height:e.properties?.height||void 0,title:e.properties?.title||void 0,loading:e.properties?.loading||void 0,decoding:e.properties?.decoding||void 0,crossorigin:e.properties?.crossorigin||void 0,referrerpolicy:e.properties?.referrerpolicy||void 0,sizes:e.properties?.sizes||void 0,srcset:e.properties?.srcset||void 0,style:e.properties?.style||void 0};return`<img ${this.formatAttributes(t)} />`}renderColumn(e,t={}){const{includeWrapper:a=!0}=t;let l="";if(a){const t="col-md-"+e.width;l+=`<div class="${t}">\n`}return e.fields.forEach(e=>{l+=this.renderField(e,t)}),a&&(l+="</div>\n"),l}renderRow(e,t={}){const{includeWrapper:a=!0}=t;let l="";return a&&(l+=`<div class="row" id="${e.id}">\n`),e.columns.forEach(e=>{l+=this.renderColumn(e,t)}),a&&(l+="</div>\n"),l}renderForm(e,t={}){const{formId:a="generated-form",formAction:l="",formMethod:i="POST"}=t;let r=`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Generated Form</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">\n</head>\n<body>\n    <div class="container mt-4">\n        <form id="${a}" action="${l}" method="${i}">\n`;return e.forEach(e=>{r+="            "+this.renderRow(e,t)}),r+='        </form>\n    </div>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"><\/script>\n</body>\n</html>',r}renderPreview(e,t={}){let a='<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Form Preview - Bootstrap</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">\n</head>\n<body>\n    <div class="container mt-4">\n        <div class="card">\n            <div class="card-header">\n                <h2 class="card-title mb-0">Form Preview</h2>\n            </div>\n            <div class="card-body">\n';return e.forEach(e=>{a+="                "+this.renderRow(e,{...t,includeWrapper:!0})}),a+='            </div>\n        </div>\n    </div>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"><\/script>\n</body>\n</html>',a}}class v extends s{renderField(e,t={}){const{includeLabels:a=!0,includeWrapper:l=!0}=t,i=this.formatAttributes(e.properties);let r="";if(l&&(r+='<div class="mb-4">\n'),a&&e.meta.label){const t=e.properties.required,a="block text-sm font-medium text-gray-700 mb-1";r+=`  <label for="${e.properties.id}" class="${a}">`,r+=this.escapeHtml(e.meta.label),t&&(r+=' <span class="text-red-500">*</span>'),r+="</label>\n"}switch(e.htmlTag){case"input":switch(e.properties.type){case"text":case"email":case"password":case"number":case"url":case"tel":r+=`  <input type="${e.properties.type}" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm" ${i} />\n`;break;case"radio":const t=this.parseSelectOptions(e.properties?.options||"");if(t.length>0){r+='  <div class="space-y-2">\n';for(let a=0;a<t.length;a++){const l=t[a];if(l){const t=`${e.properties.id}_${a}`;r+='    <div class="flex items-center">\n',r+=`      <input type="radio" id="${t}" name="${e.properties.name}" value="${this.escapeHtml(l.value)}" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300" />\n`,r+=`      <label for="${t}" class="ml-2 block text-sm text-gray-700">${this.escapeHtml(l.label)}</label>\n`,r+="    </div>\n"}}r+="  </div>\n"}break;case"submit":case"reset":let a="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2";"submit"===e.properties.type?a+=" text-white bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":a+=" text-white bg-gray-600 hover:bg-gray-700 focus:ring-gray-500";const l=e.meta.label||e.properties.value||e.properties.type.charAt(0).toUpperCase()+e.properties.type.slice(1);r+=`  <input type="${e.properties.type}" class="${a}" value="${this.escapeHtml(l)}" ${i} />\n`;break;default:r+=`  \x3c!-- Unknown input type: ${e.properties.type} --\x3e\n`}break;case"textarea":r+=`  <textarea class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm resize-y" ${i}></textarea>\n`;break;case"select":r+=`  <select class="block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm" ${i}>\n`;const t=this.parseSelectOptions(e.properties?.options||"");for(const e of t)r+=`    <option value="${this.escapeHtml(e.value)}">${this.escapeHtml(e.label)}</option>\n`;r+="  </select>\n";break;case"checkbox":r+='  <div class="flex items-center">\n',r+=`    <input type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" ${i} />\n`,e.meta.label&&(r+=`    <label for="${e.properties.id}" class="ml-2 block text-sm text-gray-700">${this.escapeHtml(e.meta.label)}</label>\n`),r+="  </div>\n";break;case"button":const a=e.properties.type||"button";let l="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2";switch(a){case"submit":l+=" text-white bg-blue-600 hover:bg-blue-700 focus:ring-blue-500";break;case"reset":l+=" text-white bg-gray-600 hover:bg-gray-700 focus:ring-gray-500";break;default:l+=" text-gray-700 bg-white hover:bg-gray-50 focus:ring-blue-500 border-gray-300"}r+=`  <button type="${a}" class="${l}" ${i}>${this.escapeHtml(e.meta.label||"Button")}</button>\n`;break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":r+=`  ${this.renderHeading(e)}\n`;break;case"p":r+=`  ${this.renderParagraph(e)}\n`;break;case"div":r+=`  ${this.renderDiv(e)}\n`;break;case"span":r+=`  ${this.renderSpan(e)}\n`;break;case"a":r+=`  ${this.renderLink(e)}\n`;break;case"pre":r+=`  ${this.renderPreformatted(e)}\n`;break;case"code":r+=`  ${this.renderCode(e)}\n`;break;case"hr":r+=`  ${this.renderHorizontalRule(e)}\n`;break;case"br":r+=`  ${this.renderLineBreak(e)}\n`;break;case"img":r+=`  ${this.renderImage(e)}\n`;break;default:r+=`  \x3c!-- Unsupported field htmlTag: ${e.htmlTag} --\x3e\n`}return e.meta.helperText&&(r+=`  <p class="mt-1 text-sm text-gray-500">${this.escapeHtml(e.meta.helperText)}</p>\n`),l&&(r+="</div>\n"),r}renderColumn(e,t={}){const a=e.width||12;let l=`<div class="${this.getTailwindColumnClass(a)}">\n`;if(e.fields&&Array.isArray(e.fields))for(const a of e.fields)l+=this.renderField(a,t);return l+="</div>\n",l}renderRow(e,t={}){let a='<div class="grid grid-cols-12 gap-4 mb-6">\n';if(e.columns&&Array.isArray(e.columns))for(const l of e.columns)a+=this.renderColumn(l,t);return a+="</div>\n",a}renderForm(e,t={}){const{formId:a="form",formAction:l="#",formMethod:i="POST"}=t;let r=`<form id="${a}" action="${l}" method="${i}" class="max-w-4xl mx-auto p-6 bg-white">\n`;for(const a of e)r+=this.renderRow(a,t);return r+="</form>\n",r}renderPreview(e,t={}){return this.generatePreviewHTML(e,t)}generateFullHTML(e,t={}){const{cssFile:a}=t;return`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Form - Tailwind CSS</title>\n    <script src="https://cdn.tailwindcss.com"><\/script>\n    ${a?`<link rel="stylesheet" href="${a}">`:""}\n    <style>\n        /* Custom Tailwind configuration */\n        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');\n        body { font-family: 'Inter', sans-serif; }\n    </style>\n</head>\n<body class="bg-gray-50 min-h-screen py-8">\n    <div class="container mx-auto px-4">\n        ${this.renderForm(e,t)}\n    </div>\n</body>\n</html>`}generatePreviewHTML(e,t={}){return`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Form Preview - Tailwind CSS</title>\n    <script src="https://cdn.tailwindcss.com"><\/script>\n    <link rel="stylesheet" href="css/preview.css">\n    <style>\n        /* Enhanced preview styling with Tailwind */\n        body { \n            font-family: 'Inter', sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        }\n        .preview-container {\n            background: rgba(255, 255, 255, 0.95);\n            backdrop-filter: blur(10px);\n            border-radius: 16px;\n            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);\n        }\n    </style>\n    <link rel="preconnect" href="https://fonts.googleapis.com">\n    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">\n</head>\n<body class="min-h-screen py-8">\n    <div class="container mx-auto px-4">\n        <div class="preview-container max-w-4xl mx-auto p-8">\n            <div class="text-center mb-8">\n                <h1 class="text-3xl font-bold text-gray-800 mb-2">Form Preview</h1>\n                <p class="text-gray-600">Powered by Tailwind CSS</p>\n            </div>\n            ${this.renderForm(e,t)}\n        </div>\n    </div>\n</body>\n</html>`}renderHeading(e){const t=e.meta?.innerHTML||e.meta?.label||"Heading",a=e.htmlTag||"h1",l={h1:"text-3xl font-bold text-gray-900",h2:"text-2xl font-semibold text-gray-900",h3:"text-xl font-semibold text-gray-900",h4:"text-lg font-medium text-gray-900",h5:"text-base font-medium text-gray-900",h6:"text-sm font-medium text-gray-900"},i={id:this.getFieldId(e),class:e.properties?.class||l[a]||l.h1,style:e.properties?.style||void 0};return`<${a} ${this.formatAttributes(i)}>${this.escapeHtml(t)}</${a}>`}renderParagraph(e){const t=e.meta?.innerHTML||e.meta?.label||"Paragraph text",a={id:this.getFieldId(e),class:e.properties?.class||"text-gray-700 leading-relaxed",style:e.properties?.style||void 0};return`<p ${this.formatAttributes(a)}>${this.escapeHtml(t)}</p>`}renderDiv(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<div ${this.formatAttributes(a)}>${this.escapeHtml(t)}</div>`}renderSpan(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||void 0,style:e.properties?.style||void 0};return`<span ${this.formatAttributes(a)}>${this.escapeHtml(t)}</span>`}renderLink(e){const t=e.meta?.innerHTML||e.meta?.label||"Link",a={id:this.getFieldId(e),href:e.properties?.href||"#",target:e.properties?.target||void 0,class:e.properties?.class||"text-blue-600 hover:text-blue-800 underline",style:e.properties?.style||void 0};return`<a ${this.formatAttributes(a)}>${this.escapeHtml(t)}</a>`}renderPreformatted(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||"bg-gray-100 p-4 rounded-md font-mono text-sm overflow-x-auto",style:e.properties?.style||void 0};return`<pre ${this.formatAttributes(a)}>${this.escapeHtml(t)}</pre>`}renderCode(e){const t=e.meta?.innerHTML||e.meta?.label||"",a={id:this.getFieldId(e),class:e.properties?.class||"bg-gray-100 px-2 py-1 rounded font-mono text-sm",style:e.properties?.style||void 0};return`<code ${this.formatAttributes(a)}>${this.escapeHtml(t)}</code>`}renderHorizontalRule(e){const t={id:this.getFieldId(e),class:e.properties?.class||"border-gray-300 my-4",style:e.properties?.style||void 0};return`<hr ${this.formatAttributes(t)} />`}renderLineBreak(e){const t={id:this.getFieldId(e),class:e.properties?.class||void 0};return`<br ${this.formatAttributes(t)} />`}renderImage(e){const t={id:this.getFieldId(e),src:e.properties?.src||"",alt:e.properties?.alt||"",class:e.properties?.class||"max-w-full h-auto rounded-lg",width:e.properties?.width||void 0,height:e.properties?.height||void 0,title:e.properties?.title||void 0,loading:e.properties?.loading||void 0,decoding:e.properties?.decoding||void 0,crossorigin:e.properties?.crossorigin||void 0,referrerpolicy:e.properties?.referrerpolicy||void 0,sizes:e.properties?.sizes||void 0,srcset:e.properties?.srcset||void 0,style:e.properties?.style||void 0};return`<img ${this.formatAttributes(t)} />`}parseSelectOptions(e){return e?e.split("\n").filter(e=>e.trim()).map(e=>{const t=e.trim();if(t.includes("|")){const[e,a]=t.split("|",2);return{label:e?.trim()||"",value:a?.trim()||""}}return{label:t,value:t}}):[]}getTailwindColumnClass(e){switch(e){case 1:return"col-span-1";case 2:return"col-span-2";case 3:return"col-span-3";case 4:return"col-span-4";case 5:return"col-span-5";case 6:return"col-span-6";case 7:return"col-span-7";case 8:return"col-span-8";case 9:return"col-span-9";case 10:return"col-span-10";case 11:return"col-span-11";default:return"col-span-12"}}}class g{static createRenderer(e="basic"){const t=this.renderers.get(e.toLowerCase());if(!t)throw Error(`Renderer for framework '${e}' not found. Available: ${Array.from(this.renderers.keys()).join(", ")}`);return t()}static getAvailableFrameworks(){return Array.from(this.renderers.keys())}static registerRenderer(e,t){this.renderers.set(e.toLowerCase(),t)}static renderForm(e,t="basic",a={}){return this.createRenderer(t).renderForm(e,{...a,framework:t})}static renderPreview(e,t="basic",a={}){return this.createRenderer(t).renderPreview(e,{...a,framework:t})}static renderField(e,t="basic",a={}){return this.createRenderer(t).renderField(e,{...a,framework:t})}}g.renderers=new Map([["basic",()=>new f],["bootstrap",()=>new y],["tailwind",()=>new v],["preview",()=>new b]]);class x{constructor(e="basic"){this.framework=e,this.renderer=g.createRenderer(e)}generateForm(e,t={}){return this.renderer.renderForm(e,{...t,framework:this.framework})}generatePreview(e,t={}){return this.renderer.renderPreview(e,{...t,framework:this.framework})}generateField(e,t={}){return this.renderer.renderField(e,{...t,framework:this.framework})}generateRow(e,t={}){return this.renderer.renderRow(e,{...t,framework:this.framework})}generateColumn(e,t={}){return this.renderer.renderColumn(e,{...t,framework:this.framework})}setFramework(e){this.framework=e,this.renderer=g.createRenderer(e)}getFramework(){return this.framework}static getAvailableFrameworks(){return g.getAvailableFrameworks()}}class w{constructor(e){this.container=e,this.scopeId=this.generateScopeId(),this.markContainerScope()}generateScopeId(){return`fb-scope-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}markContainerScope(){this.container.setAttribute("data-formbuilder-scope",this.scopeId),this.container.setAttribute("data-fb-version","0.1.0"),this.container.setAttribute("data-fb-initialized",(new Date).toISOString())}querySelector(e){try{return this.container.querySelector(e)}catch(e){return null}}querySelectorAll(e){try{return this.container.querySelectorAll(e)}catch(e){return document.querySelectorAll("")}}getElementById(e){return this.container.querySelector("#"+CSS.escape(e))}addEventListener(e,t,a){this.container.addEventListener(e,t,a)}removeEventListener(e,t){this.container.removeEventListener(e,t)}createElement(e,t){const a=document.createElement(e);return a.setAttribute("data-fb-scope",this.scopeId),a.setAttribute("data-fb-created","true"),t&&Object.entries(t).forEach(([e,t])=>{a.setAttribute(e,t)}),a}createElementWithId(e,t,a){const l=this.getScopedId(t);return this.createElement(e,{id:l,...a})}getScopedId(e){return`${this.scopeId}-${e}`}isInScope(e){return!!e&&this.container.contains(e)}validateOperation(e,t="operation"){return!(!e||!this.isPropertyPanelElement(e)&&!this.isInScope(e)&&("undefined"!=typeof window&&window.location.hostname,1))}isPropertyPanelElement(e){let t=e;for(;t;){if(t.classList.contains("properties-panel")||t.classList.contains("properties-content")||t.classList.contains("property-group")||t.classList.contains("btn-delete-element")||"deleteElement"===t.id)return!0;t=t.parentElement}return!1}safeAppendChild(e,t){if(!this.validateOperation(e,"appendChild on parent")||!this.validateOperation(t,"appendChild on child"))return!1;try{return e.appendChild(t),!0}catch(e){return!1}}safeRemoveChild(e,t){if(!this.validateOperation(e,"removeChild on parent")||!this.validateOperation(t,"removeChild on child"))return!1;try{return e.removeChild(t),!0}catch(e){return!1}}safeSetAttribute(e,t,a){if(!this.validateOperation(e,"setAttribute "+t))return!1;try{return e.setAttribute(t,a),!0}catch(e){return!1}}safeRemoveAttribute(e,t){if(!this.validateOperation(e,"removeAttribute "+t))return!1;try{return e.removeAttribute(t),!0}catch(e){return!1}}getContainer(){return this.container}getScopeId(){return this.scopeId}getDebugInfo(){return{scopeId:this.scopeId,containerTagName:this.container.tagName,containerId:this.container.id,containerClasses:this.container.className,elementsInScope:this.container.querySelectorAll("[data-fb-scope]").length,initialized:this.container.getAttribute("data-fb-initialized")}}cleanup(){this.container.querySelectorAll(`[data-fb-scope="${this.scopeId}"]`).forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.container.removeAttribute("data-formbuilder-scope"),this.container.removeAttribute("data-fb-version"),this.container.removeAttribute("data-fb-initialized")}}class AstraFormBuilder extends e{constructor(e,a){if(super(),this.rows=[],this.formElement=null,this.selectedElement=null,this.debugMode=!1,this.canvasClickHandler=null,this.addColumnDebounce={},this.isLoaded=!1,this.elementCounters={},this.container=this.resolveContainer(e),this.scopedDOM=new w(this.container),void 0!==a?.debug&&(this.debugMode=a.debug),this.elementRegistry=new t,a?.elementRegistry)try{this.elementRegistry.loadCustomRegistry(a.elementRegistry),this.debugMode}catch(e){const t=e instanceof Error?e.message:"Unknown error";throw Error("Invalid ElementRegistry configuration: "+t)}this.previewRenderer=new b,this.createFormBuilderStructure(),this.canvas=this.scopedDOM.getElementById(this.scopedDOM.getScopedId("formCanvas")),this.toolbox=this.scopedDOM.querySelector(".toolbox"),this.propertiesPanel=this.scopedDOM.getElementById(this.scopedDOM.getScopedId("propertiesPanel"));const l=this.scopedDOM.getElementById(this.scopedDOM.getScopedId("propertiesContent"));this.propertyPanelInstance=new i(l),this.dragDropManager=new r(this.container,this.scopedDOM),this.init(),a?.form&&this.loadInitialForm(a.form)}loadInitialForm(e){try{let t;if(!Array.isArray(e)&&"version"in e){const a={};e.metadata.title&&(a.title=e.metadata.title),e.metadata.description&&(a.description=e.metadata.description),e.version&&(a.version=e.version),e.metadata.created&&(a.createdAt=e.metadata.created),t={formElement:null,rows:e.rows,metadata:a}}else t=e;this.importForm(t),this.debugMode}catch(e){const t=e instanceof Error?e.message:"Unknown error";throw Error("Invalid initial form data: "+t)}}resolveContainer(e){if(e instanceof HTMLElement)return e;if("string"==typeof e){let t=null;if(e.startsWith("#")){const a=e.substring(1);if(t=document.getElementById(a),!t)throw Error(`FormBuilder Error: Element with ID "${a}" not found. Make sure the element exists in the DOM before initializing FormBuilder.`)}else if(e.startsWith(".")){const a=e.substring(1),l=document.getElementsByClassName(a);if(0===l.length)throw Error(`FormBuilder Error: No elements found with class "${a}". Make sure at least one element with this class exists in the DOM.`);l.length,t=l[0]}else if(t=document.getElementById(e),!t)throw Error(`FormBuilder Error: Element with ID "${e}" not found. Make sure the element exists in the DOM before initializing FormBuilder.`);if(!t)throw Error(`FormBuilder Error: Unable to find element with selector "${e}". Please check your selector and ensure the element exists in the DOM.`);return t}throw Error(`FormBuilder Error: Invalid container parameter. Expected string selector or HTMLElement, received ${typeof e}.`)}createFormBuilderStructure(){const e=this.scopedDOM.getScopedId("formCanvas"),t=this.scopedDOM.getScopedId("propertiesPanel"),a=this.scopedDOM.getScopedId("propertiesContent"),l=this.scopedDOM.getScopedId("elementsList"),i=this.scopedDOM.getScopedId("dropZone");this.container.innerHTML=`\n            \x3c!-- Main Content --\x3e\n            <div class="main-content">\n                \x3c!-- Toolbox --\x3e\n                <aside class="toolbox">\n                    <h3>Elements Toolbox</h3>\n                    <div id="${l}">\n                        \x3c!-- Elements will be populated by JavaScript organized by categories --\x3e\n                    </div>\n                </aside>\n\n                \x3c!-- Form Canvas --\x3e\n                <main class="canvas-container">\n                    <div class="canvas form-canvas drop-zone" id="${e}">\n                        <div class="drop-zone" id="${i}">\n                            <div class="drop-zone-placeholder">\n                                <p>Drag elements here to build your form</p>\n                            </div>\n                        </div>\n                    </div>\n                </main>\n\n                \x3c!-- Properties Panel --\x3e\n                <aside class="properties-panel" id="${t}">\n                    <h3>Properties</h3>\n                    <div class="properties-content" id="${a}">\n                        <p class="no-selection">Select an element to edit its properties</p>\n                    </div>\n                </aside>\n            </div>\n        `}init(){this.setupEventListeners(),this.populateToolbox(),this.setupDragAndDrop(),this.setupDebugToggle(),this.render(),this.isLoaded=!0,this.dispatchFormBuilderLoadedEvent()}toSlug(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}dispatchFormBuilderLoadedEvent(){const e=new CustomEvent("formbuilder:loaded",{detail:{formBuilder:this,isReady:!0,timestamp:(new Date).toISOString()},bubbles:!0,cancelable:!1});this.container.dispatchEvent(e),this.debugMode}generateUniqueId(e){return e in this.elementCounters||(this.elementCounters[e]=0),this.elementCounters[e]=(this.elementCounters[e]||0)+1,`${this.toSlug(e)}-${this.elementCounters[e]}`}resetElementCounters(){this.elementCounters={}}updateCountersFromExistingData(){this.resetElementCounters(),this.formElement&&this.updateCounterFromId("form",this.formElement.id),this.rows.forEach(e=>{this.updateCounterFromId("row",e.id),e.columns.forEach(e=>{this.updateCounterFromId("column",e.id),e.fields.forEach(e=>{this.updateCounterFromId(e.htmlTag,e.id)})})})}updateCounterFromId(e,t){const a=this.toSlug(e),l=RegExp(`^${a}-(\\d+)$`),i=t.match(l);if(i&&i[1]){const t=parseInt(i[1],10);isNaN(t)||(this.elementCounters[e]=Math.max(this.elementCounters[e]||0,t))}}isFormElement(e){const t=this.elementRegistry.get(e);return!!t&&m.isFormControl(t.htmlTag)}findElement(e){return this.scopedDOM.querySelector(e)}findElements(e){return this.scopedDOM.querySelectorAll(e)}findById(e){return this.scopedDOM.getElementById(e)}safeAppendChild(e,t){return this.scopedDOM.safeAppendChild(e,t)}safeRemoveChild(e,t){return this.scopedDOM.safeRemoveChild(e,t)}safeSetAttribute(e,t,a){return this.scopedDOM.safeSetAttribute(e,t,a)}safeRemoveAttribute(e,t){return this.scopedDOM.safeRemoveAttribute(e,t)}validateElementOperation(e,t){return this.scopedDOM.validateOperation(e,t)}createScopedElement(e,t){return this.scopedDOM.createElement(e,t)}createScopedElementWithId(e,t,a){return this.scopedDOM.createElementWithId(e,t,a)}setupEventListeners(){this.propertyPanelInstance.on("propertyChanged",this.handlePropertyChange.bind(this)),this.propertyPanelInstance.on("deleteElement",this.handleDeleteElement.bind(this)),this.setupScopedEventListeners()}setupScopedEventListeners(){this.scopedDOM.addEventListener("click",e=>this.handleScopedClick(e)),this.scopedDOM.addEventListener("dragstart",e=>this.handleScopedDragStart(e)),this.scopedDOM.addEventListener("dragover",e=>this.handleScopedDragOver(e)),this.scopedDOM.addEventListener("drop",e=>this.handleScopedDrop(e)),this.scopedDOM.addEventListener("dragenter",e=>this.handleScopedDragEnter(e)),this.scopedDOM.addEventListener("dragleave",e=>this.handleScopedDragLeave(e))}handleScopedClick(e){const t=e.target;if(!this.validateElementOperation(t,"click"))return;const a=t.closest(".element-item");if(a&&a.dataset.elementType){e.preventDefault();const t=a.dataset.elementType;return this.debugMode,void this.addElementByClick(t)}this.canvasClickHandler&&this.canvasClickHandler(e)}handleScopedDragStart(e){const t=e.target;this.validateElementOperation(t,"dragstart")||e.preventDefault()}handleScopedDragOver(e){const t=e.target;this.validateElementOperation(t,"dragover")&&e.preventDefault()}handleScopedDrop(e){const t=e.target;this.validateElementOperation(t,"drop")}handleScopedDragEnter(e){const t=e.target;this.validateElementOperation(t,"dragenter")}handleScopedDragLeave(e){const t=e.target;this.validateElementOperation(t,"dragleave")}setupDragAndDrop(){this.dragDropManager.on("elementDropped",this.handleElementDropped.bind(this)),this.debugMode}handleSidebarDrop(e){e.preventDefault(),e.stopPropagation();const t=e.dataTransfer?.getData("text/plain");if(t){const a=e.target,l=a.closest(".form-column"),i=a.closest(".form-row");if("form"===t)return void this.createFormElement();if("row"===t)this.debugMode,this.createRow();else if("column"===t)if(i){const e=i.dataset.rowId;this.debugMode,e&&this.addColumnToRowById(e)}else this.debugMode,this.createRow();else if(l){const e=l.dataset.elementId;this.debugMode,this.createElementInColumn(t,e)}else if(i){const e=i.dataset.rowId;this.debugMode,this.createElementInRow(t,e)}else this.debugMode,this.createElementInNewRow(t)}}handleInternalDrop(e){const t=e.dataTransfer?.getData("application/x-element-id"),a=e.dataTransfer?.getData("application/x-element-type");if(!t||!a)return;const l=e.target;l.closest(".form-column"),l.closest(".form-row"),this.debugMode,"row"===a?this.moveRow(t,l,e):"column"===a?this.moveColumn(t,l):"field"===a&&this.moveField(t,l)}createElementInColumn(e,t){let a=null;for(const e of this.rows){for(const l of e.columns)if(l.id===t){a=l;break}if(a)break}if(!a)return;const i=l.generateId(),r=this.elementRegistry.get(e);if(r){const t={};if(r.properties)for(const[e,a]of Object.entries(r.properties))t[e]=a.defaultValue||"";const l=this.generateUniqueId(e);t.id=l,r.properties?.name&&(t.name=l);const n={};if(r.meta)for(const[e,t]of Object.entries(r.meta))n[e]=t.defaultValue||"";this.isFormElement(e)&&r.meta?.label&&(n.label=l);const s={id:i,elementRegistryId:e,htmlTag:r.htmlTag,properties:t,meta:n,events:{}};a.fields.push(s),this.render(),this.emitFormChange()}}createElementInRow(e,t){this.debugMode;const a=this.rows.find(e=>e.id===t);if(!a)return;if(0===a.columns.length){const e=this.generateUniqueId("column"),t={id:e,width:12,fields:[],properties:{id:e}};a.columns.push(t)}const l=a.columns[0];l&&this.createElementInColumn(e,l.id)}createElementInNewRow(e){this.debugMode;const t=this.generateUniqueId("row"),a=this.generateUniqueId("column"),l={id:t,columns:[{id:a,width:12,fields:[],properties:{id:a}}],properties:{id:t}};this.rows.push(l),this.createElementInColumn(e,a),this.emitFormChange()}createFormElement(){if(this.formElement)return void alert("Only one form element is allowed per form builder. Please remove the existing form element first.");this.debugMode;const e=this.elementRegistry.get("form");if(!e)return;const t={};if(e.properties)for(const[a,l]of Object.entries(e.properties))t[a]=l.defaultValue||"";const a=this.generateUniqueId("form");t.id=a,e.properties?.name&&(t.name=a);const i={};if(e.events)for(const[t,a]of Object.entries(e.events))i[t]=a.defaultValue||{};this.formElement={id:l.generateId(),elementRegistryId:"form",htmlTag:e.htmlTag,properties:t,meta:{},events:i},this.render(),this.emitFormChange()}setupDebugToggle(){const e=this.findElement("#debugToggle");e&&e.addEventListener("click",()=>{this.debugMode=!this.debugMode,this.debugMode?(this.container.classList.add("debug-mode"),e.textContent="üêõ Debug: ON",e.classList.add("btn-success"),e.classList.remove("btn-secondary")):(this.container.classList.remove("debug-mode"),e.textContent="üêõ Debug",e.classList.add("btn-secondary"),e.classList.remove("btn-success")),this.render()})}highlightElement(e){this.scopedDOM.querySelectorAll(".selected").forEach(e=>{e.classList.remove("selected")});const t=this.scopedDOM.querySelector(`[data-element-id="${e}"]`);t&&t.classList.add("selected")}handlePropertyChange(e){const{elementId:t,property:a,value:l,section:i="properties"}=e,r=this.findElementById(t);if(r){switch(i){case"properties":r.properties||(r.properties={}),r.properties[a]=l;break;case"meta":const e=r;e.meta||(e.meta={}),e.meta[a]=l;break;case"events":const t=r;t.events||(t.events={}),t.events[a]=l;break;case"alpine":const i=r;i.alpine||(i.alpine={}),i.alpine[a]=l;break;default:return}this.render(),this.emitFormChange(),this.emit("propertyChanged",e)}}handleDeleteElement(e){const{elementId:t}=e;this.deleteElement(t)}handleElementDropped(e){const{data:t,dropTarget:a,event:l}=e,{elementType:i,isNew:r,elementId:n,sourceType:s}=t;this.debugMode,r?this.handleSidebarDrop(l):this.handleInternalDrop(l)}findElementById(e){if(this.formElement&&this.formElement.id===e)return this.formElement;for(const t of this.rows){if(t.id===e)return t;for(const a of t.columns){if(a.id===e)return a;for(const t of a.fields)if(t.id===e)return t}}return null}addElementByClick(e){try{if(!this.formElement){const e=this.generateUniqueId("form"),t=this.elementRegistry.get("form");if(!t)return;const a={id:e,name:e,method:"POST",action:"",class:"",enctype:"application/x-www-form-urlencoded"},i={onChange:{action:"validate",target:"vanilla",parameters:{}},onSubmit:{action:"submit",target:"vanilla",parameters:{}}};this.formElement={id:l.generateId(),elementRegistryId:"form",htmlTag:t.htmlTag,properties:a,meta:{},events:i}}let t,a;const i=this.generateUniqueId("row"),r=this.generateUniqueId("column");t={id:i,columns:[],properties:{id:i}},a={id:r,width:12,fields:[],properties:{id:r}},t.columns.push(a),this.rows.push(t);const n=this.generateUniqueId(e),s=this.elementRegistry.get(e);if(!s)return;const o={id:n,name:n};if(s.properties)for(const[e,t]of Object.entries(s.properties))o[e]=t.defaultValue||"";const d={label:n};if(s.meta)for(const[e,t]of Object.entries(s.meta))d[e]=t.defaultValue||"";const u={id:l.generateId(),elementRegistryId:e,htmlTag:s.htmlTag,properties:o,meta:d,events:{}};a.fields.push(u),this.debugMode,this.render(),this.emitFormChange(),this.selectElement(u.id)}catch(e){}}addElement(e){}deleteElement(e){if(this.debugMode,this.formElement&&this.formElement.id===e)return this.debugMode,this.formElement=null,this.propertyPanelInstance.hideProperties(),this.render(),void this.emitFormChange();for(let t=0;t<this.rows.length;t++){const a=this.rows[t];if(a){if(a.id===e)return this.rows.splice(t,1),this.render(),void this.emitFormChange();for(let t=0;t<a.columns.length;t++){const l=a.columns[t];if(l){if(l.id===e){a.columns.splice(t,1);const e=Math.floor(12/Math.max(1,a.columns.length));return a.columns.forEach(t=>t.width=e),this.render(),void this.emitFormChange()}for(let t=0;t<l.fields.length;t++){const a=l.fields[t];if(a&&a.id===e)return l.fields.splice(t,1),this.render(),void this.emitFormChange()}}}}}}exportForm(){return{formElement:this.formElement,rows:this.rows,metadata:{title:"Form Builder Layout",description:"Form layout created with Form Builder",version:"0.1.0",createdAt:(new Date).toISOString()}}}importForm(e){Array.isArray(e)?(this.rows=e,this.formElement=null):(this.formElement=e.formElement||null,this.rows=e.rows||[]),this.updateCountersFromExistingData(),this.render(),this.emitFormChange()}exportJsonFile(e){try{const t={title:"Form Builder Layout",description:"Form layout created with Form Builder",version:"0.1.0",createdAt:(new Date).toISOString()},a={formElement:this.formElement,rows:this.rows,metadata:t},l=JSON.stringify(a,null,2),i=new Blob([l],{type:"application/json"}),r=URL.createObjectURL(i),n=document.createElement("a");n.href=r,n.download=e||"form-layout.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),this.debugMode}catch(e){alert("Error exporting form. Please check the console for details.")}}toJSON(){try{const e={metadata:{title:"Form Builder Layout",description:"Form layout created with Form Builder",createdAt:(new Date).toISOString(),version:"0.1.0"},formElement:this.formElement,rows:this.rows,elementCount:this.getTotalElementCount(),preview:n.createPreview(this.rows)};return this.dispatchJsonDataReadyEvent(e),this.debugMode,e}catch(e){throw e}}fromJSON(e){try{if(!e)throw Error("JSON data is required");let t,a=null;if(Array.isArray(e))t=e,a=null;else{if(!e.rows||!Array.isArray(e.rows))throw Error("Invalid JSON format: expected array of rows or object with rows property");t=e.rows,a=e.formElement||null,this.debugMode}if(!Array.isArray(t))throw Error("Invalid data: rows must be an array");this.formElement=a,this.rows=t,this.updateCountersFromExistingData(),this.selectedElement=null,this.showNoSelectionPanel(),this.render(),this.emit("form:changed",this.rows),this.debugMode,this.dispatchFormImportedEvent(e)}catch(e){const t=e instanceof Error?e.message:"Unknown error occurred";throw alert("Failed to load form: "+t),e}}dispatchJsonDataReadyEvent(e){const t=new CustomEvent("json:data:ready",{detail:{formBuilder:this,jsonData:e,timestamp:(new Date).toISOString()},bubbles:!0,cancelable:!1});this.container.dispatchEvent(t),this.debugMode}getTotalElementCount(){let e=0;for(const t of this.rows)for(const a of t.columns)e+=a.fields.length;return e}isFormBuilderLoaded(){return this.isLoaded}getFormBuilderInstance(){return this}showNoSelectionPanel(){this.propertiesPanel&&(this.propertiesPanel.innerHTML='\n                <h3>Properties</h3>\n                <div class="properties-content">\n                    <p class="no-selection">Select an element to edit its properties</p>\n                </div>\n            ')}dispatchFormImportedEvent(e){const t=new CustomEvent("form:imported",{detail:{formBuilder:this,importedData:e,timestamp:(new Date).toISOString()},bubbles:!0,cancelable:!1});this.container.dispatchEvent(t),this.debugMode}async importFromJSON(e){try{let t=e;if(!t){const e=document.createElement("input");return e.type="file",e.accept=".json",e.style.display="none",new Promise((t,a)=>{e.onchange=async l=>{const i=l.target;if(document.body.removeChild(e),i.files?.[0])try{await this.importFromJSON(i.files[0]),t()}catch(e){a(e)}else a(Error("No file selected"))},e.oncancel=()=>{document.body.removeChild(e),a(Error("File selection cancelled"))},document.body.appendChild(e),e.click()})}const a=await t.text(),l=n.import(a);this.importForm(l),this.debugMode&&(Array.isArray(l)?n.createPreview(l):n.createPreview(l.rows));const i=Array.isArray(l)?n.createPreview(l):n.createPreview(l.rows);alert("Form imported successfully! "+i)}catch(e){alert("Error importing form. Please check the file format and try again.")}}clearForm(){this.debugMode,0!==this.rows.length?confirm("Are you sure you want to clear the entire form? This action cannot be undone.")&&(this.debugMode,this.rows=[],this.formElement=null,this.resetElementCounters(),this.propertyPanelInstance.hideProperties(),this.render(),this.emitFormChange(),this.debugMode):alert("Form is already empty.")}async generateHTML(e="basic",t={}){return new x(e).generateForm(this.rows,t)}async generatePreview(e="basic",t={}){return new x(e).generatePreview(this.rows,t)}async downloadHTML(e="basic",t,a={}){try{const l=await this.generateHTML(e,a),i=new Blob([l],{type:"text/html"}),r=URL.createObjectURL(i),n=document.createElement("a");n.href=r,n.download=t||`form-${e}.html`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),this.debugMode}catch(e){alert("Error generating HTML. Please try again.")}}async downloadPreview(e="basic",t,a={}){try{const l=await this.generatePreview(e,a),i=new Blob([l],{type:"text/html"}),r=URL.createObjectURL(i),n=document.createElement("a");n.href=r,n.download=t||`preview-${e}.html`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),this.debugMode}catch(e){alert("Error generating preview. Please try again.")}}setDebugMode(e){this.debugMode=e,this.debugMode}isDebugModeEnabled(){return this.debugMode}getFormData(){return JSON.parse(JSON.stringify(this.rows))}setFormData(e){this.rows=e,this.render(),this.propertyPanelInstance.hideProperties(),this.emitFormChange()}onFormChange(e){this.on("form-changed",e)}offFormChange(e){this.off("form-changed",e)}emitFormChange(){this.emit("form-changed",this.getFormData())}render(){const e=this.scopedDOM.getElementById(this.scopedDOM.getScopedId("dropZone"));if(!e)return;let t="";if(this.formElement&&(t+=this.renderFormElementHtml()),0===this.rows.length&&!this.formElement){e.innerHTML='\n                <div class="drop-zone-placeholder">\n                    <p>Drag elements to create rows and columns</p>\n                </div>\n            ';const t=e.querySelector("#createRowBtn");return t&&t.addEventListener("click",()=>{this.createRow()}),void this.dragDropManager.refresh()}this.rows.length>0&&(t+=this.rows.map((e,t)=>this.renderRowHtml(e,t)).join("")),this.formElement&&0===this.rows.length&&(t+='\n                <div class="drop-zone-placeholder" style="margin-top: 1rem;">\n                    <p>Drag elements to add form fields</p>\n                </div>\n            '),e.innerHTML=t,this.attachRowEventListeners(),this.dragDropManager.refresh()}renderFormElementHtml(){if(!this.formElement)return"";const e=this.debugMode?` (ID: ${this.formElement.id})`:"",t=this.formElement.properties?.name||"Form";return`\n            <div class="form-element-container" data-element-id="${this.formElement.id}" data-element-type="form">\n                <div class="element-header">\n                    <div class="header-left">\n                        <span class="element-icon">üìã</span>\n                        <span class="element-title">${t}${e}</span>\n                    </div>\n                    <div class="header-right">\n                        <button class="header-btn delete-element-btn" data-element-id="${this.formElement.id}" data-element-type="form" title="Remove Form">\n                            üóëÔ∏è\n                        </button>\n                        <button class="header-btn settings-btn" data-element-id="${this.formElement.id}" title="Form Settings">\n                            ‚öôÔ∏è\n                        </button>\n                    </div>\n                </div>\n                <div class="form-element-content">\n                    <div class="form-element-preview">\n                        <div class="form-element-icon">üìã</div>\n                        <div class="form-element-info">\n                            <h4>${t}</h4>\n                            <div class="form-element-properties">\n                                <span><strong>ID:</strong> ${this.formElement.properties?.id||"form"}</span>\n                                <span><strong>Name:</strong> ${this.formElement.properties?.name||"(not set)"}</span>\n                                <span><strong>Method:</strong> ${this.formElement.properties?.method||"post"}</span>\n                                <span><strong>Action:</strong> ${this.formElement.properties?.action||"(not set)"}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `}renderRowHtml(e,t){const a=e.columns.map((e,a)=>this.renderColumnHtml(e,t,a)).join(""),l=this.debugMode?` (ID: ${e.id})`:"";return`\n            <div class="form-row drop-zone" data-row-id="${e.id}" data-element-id="${e.id}" data-element-type="row">\n                <div class="element-header">\n                    <div class="header-left">\n                        <span class="element-icon">üìê</span>\n                        <span class="element-title">Linha (${t+1})${l}</span>\n                    </div>\n                    <div class="header-right">\n                        <button class="header-btn delete-element-btn" data-element-id="${e.id}" data-element-type="row" title="Excluir Linha">\n                            üóëÔ∏è\n                        </button>\n                        <button class="header-btn add-column-btn" data-row-id="${e.id}" title="Adicionar Coluna">\n                            ‚ûï\n                        </button>\n                        <button class="header-btn drag-handle-btn" data-element-id="${e.id}" data-element-type="row" title="Mover Linha" draggable="true">\n                            üïπÔ∏è\n                        </button>\n                    </div>\n                </div>\n                <div class="row-content">\n                    ${a}\n                </div>\n            </div>\n        `}renderColumnHtml(e,t,a){const l=e.fields.map((e,l)=>this.renderFieldHtml(e,t,a,l)).join(""),i=this.debugMode?` (${e.width}/12) - ID: ${e.id}`:"";return`\n            <div class="form-column col-${e.width}" data-element-id="${e.id}" data-element-type="column">\n                <div class="element-header">\n                    <div class="header-left">\n                        <span class="element-icon">üìè</span>\n                        <span class="element-title">Coluna (${t+1},${a+1})${i}</span>\n                    </div>\n                    <div class="header-right">\n                        <button class="header-btn delete-element-btn" data-element-id="${e.id}" data-element-type="column" title="Excluir Coluna">\n                            üóëÔ∏è\n                        </button>\n                        <button class="header-btn drag-handle-btn" data-element-id="${e.id}" data-element-type="column" title="Mover Coluna" draggable="true">\n                            üïπÔ∏è\n                        </button>\n                    </div>\n                </div>\n                <div class="column-content drop-zone-column">\n                    ${l||'<div class="column-placeholder">Drop campos aqui</div>'}\n                </div>\n            </div>\n        `}renderFieldHtml(e,t,a,l){const i=this.elementRegistry.get(e.elementRegistryId);if(!i)return"";const r=this.debugMode?" - ID: "+e.id:"";return`\n            <div class="form-field" data-element-id="${e.id}" data-element-type="field">\n                <div class="element-header">\n                    <div class="header-left">\n                        <span class="element-icon">${i.icon}</span>\n                        <span class="element-title">${i.label} (${t+1},${a+1},${l+1})${r}</span>\n                    </div>\n                    <div class="header-right">\n                        <button class="header-btn delete-element-btn" data-element-id="${e.id}" data-element-type="field" title="Excluir Campo">\n                            üóëÔ∏è\n                        </button>\n                        <button class="header-btn settings-btn" data-element-id="${e.id}" title="Propriedades do Campo">\n                            ‚öôÔ∏è\n                        </button>\n                        <button class="header-btn drag-handle-btn" data-element-id="${e.id}" data-element-type="field" title="Mover Campo" draggable="true">\n                            üïπÔ∏è\n                        </button>\n                    </div>\n                </div>\n                <div class="field-content">\n                    ${this.generateFieldPreview(e,i)}\n                </div>\n            </div>\n        `}generateFieldPreview(e,t){return this.previewRenderer.renderField(e,{includeLabels:!0,includeWrapper:!1})}populateToolbox(){const e=this.findById(this.scopedDOM.getScopedId("elementsList"));if(!e)return;const t=this.elementRegistry.getAll().reduce((e,t)=>{const a=t.category||"other";return e[a]||(e[a]=[]),e[a].push(t),e},{}),a={layout:"Layout",form:"Form Controls",content:"Content",media:"Media",other:"Other"};e.innerHTML=["layout","form","content","media","other"].filter(e=>t[e]&&t[e].length>0).map((e,l)=>`\n                <div class="elements-category">\n                    <div class="category-header" data-category="${e}">\n                        <span>${a[e]||e}</span>\n                        <span class="category-toggle expanded">‚ñ∂</span>\n                    </div>\n                    <div class="elements-list expanded" data-category-content="${e}">\n                        ${(t[e]||[]).map(e=>`\n                            <div class="element-item" \n                                 data-element-type="${e.id}" \n                                 draggable="true"\n                                 title="${e.label}">\n                                <div class="element-icon">${e.icon}</div>\n                                <div class="element-label">${e.label}</div>\n                            </div>\n                        `).join("")}\n                    </div>\n                </div>\n            `).join(""),this.setupCategoryToggle()}setupCategoryToggle(){this.findElements(".category-header").forEach(e=>{e.addEventListener("click",t=>{const a=e.getAttribute("data-category"),l=e.querySelector(".category-toggle"),i=this.findElement(`[data-category-content="${a}"]`);i&&l&&(l.classList.contains("expanded")?(l.classList.remove("expanded"),i.classList.remove("expanded")):(l.classList.add("expanded"),i.classList.add("expanded")))})})}clear(){this.rows=[],this.render()}createRow(){const e=this.generateUniqueId("row"),t=this.generateUniqueId("column"),a={id:e,columns:[{id:t,width:12,fields:[],properties:{id:t}}],properties:{id:e}};this.rows.push(a),this.render()}testAddColumn(){this.rows.length>0&&this.rows[0]&&this.addColumnToRowById(this.rows[0].id)}addColumnToRow(){if(0===this.rows.length)return void this.createRow();const e=this.rows[0];if(!e)return;const t=this.generateUniqueId("column"),a={id:t,width:Math.floor(12/(e.columns.length+1)),fields:[],properties:{id:t}},l=Math.floor(12/(e.columns.length+1));e.columns.forEach(e=>e.width=l),e.columns.push(a),this.render()}createField(e){0===this.rows.length&&this.createRow();const t=this.rows[0];if(!t||0===t.columns.length)return;const a=t.columns[0];if(!a)return;const i=this.elementRegistry.get(e);if(!i)return;const r={};if(i.properties)for(const[e,t]of Object.entries(i.properties))r[e]=t.defaultValue||"";const n={};if(i.meta)for(const[e,t]of Object.entries(i.meta))n[e]=t.defaultValue||"";const s={};if(i.events)for(const[e,t]of Object.entries(i.events))s[e]=t.defaultValue||{action:"",target:"vanilla",parameters:{}};const o={};if(i.alpine)for(const[e,t]of Object.entries(i.alpine))o[e]=t.defaultValue||"";const d=l.generateId(),u=this.generateUniqueId(e);this.isFormElement(e)&&i.meta?.label&&(n.label=u);const c={id:d,elementRegistryId:e,htmlTag:i.htmlTag,properties:{...r,id:u,name:i.properties?.name?u:void 0},meta:n,events:s,alpine:o};a.fields.push(c),this.render()}moveElement(e,t){}renderRow(e){this.render()}attachRowEventListeners(){this.canvasClickHandler&&this.scopedDOM.removeEventListener("click",this.canvasClickHandler),this.canvasClickHandler=e=>{const t=e.target,a=t.closest(".add-column-btn");if(a){this.debugMode,e.preventDefault(),e.stopPropagation();const t=a.dataset.rowId;t&&this.addColumnToRowById(t)}else{const a=t.closest(".delete-element-btn"),l=t.closest(".settings-btn");if(a){e.preventDefault();const t=a.dataset.elementId;t&&this.deleteElement(t)}else if(l){e.preventDefault();const t=l.dataset.elementId;t&&this.selectElement(t)}else{const a=t.closest("[data-element-id]");if(a){const t=a.dataset.elementType;if(a.classList.contains("form-column")||a.classList.contains("column-placeholder")||a.classList.contains("form-column-placeholder"))return;"field"===t||"form"===t?(e.preventDefault(),this.selectElement(a.dataset.elementId)):"row"!==t&&"column"!==t||this.selectElement(a.dataset.elementId)}}}},this.scopedDOM.addEventListener("click",this.canvasClickHandler),this.scopedDOM.querySelectorAll(".add-column-btn").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const a=e.dataset.rowId;a&&this.addColumnToRowById(a)})})}addColumnToRowById(e){const t=this.rows.find(t=>t.id===e);if(!t)return;if(t.columns.length>=12)return void alert("N√£o √© poss√≠vel adicionar mais de 12 colunas em uma linha!");const a=t.columns.length,l=a+1,i=Math.floor(12/l),r=12%l,n=this.generateUniqueId("column"),s={id:n,width:i+(r>a?1:0),fields:[],properties:{id:n}};t.columns.forEach((e,t)=>{e.width=i+(r>t?1:0)}),t.columns.push(s),this.render()}selectElement(e){if(this.formElement&&this.formElement.id===e){this.selectedElement=this.formElement;const e=this.elementRegistry.get("form");return void(e&&this.propertyPanelInstance.showProperties(this.formElement,e,"form"))}let t=null;for(const a of this.rows){if(a.id===e){t=a;break}for(const l of a.columns){if(l.id===e){t=l;break}for(const a of l.fields)if(a.id===e){t=a;break}if(t)break}if(t)break}if(t){this.selectedElement=t;let e="";"elementRegistryId"in t&&t.elementRegistryId?e=t.elementRegistryId:"columns"in t?e="row":"fields"in t&&(e="column");const a=this.elementRegistry.get(e);if(a){const l="row"===e?"row":"column"===e?"column":"field";a.category,this.propertyPanelInstance.showProperties(t,a,l)}}}createElement(e,t){return this.createElementPrivate(e,t)}createElementPrivate(e,t){this.elementRegistry.get(e)&&("row"===e?this.createRow():"column"===e?this.addColumnToRow():this.createField(e))}moveRow(e,t,a){this.debugMode;const l=this.rows.findIndex(t=>t.id===e);if(-1===l)return;const i=this.rows[l];if(!i)return;const r=t.closest(".form-canvas"),n=t.closest(".form-row");if(r&&!n){const e=r.getBoundingClientRect(),t=a?.clientY||0,n=e.height,s=t-e.top;this.rows.splice(l,1);let o=0;return o=s>.8*n?this.rows.length:.2*n>s?0:Math.floor(this.rows.length/2),this.rows.splice(o,0,i),this.render(),this.emitFormChange(),void this.debugMode}if(n){const e=n.dataset.rowId,t=this.rows.findIndex(t=>t.id===e);if(-1!==t&&t!==l){this.rows.splice(l,1);const e=t>l?t-1:t;let r=e;if(a){const t=n.getBoundingClientRect(),l=a.clientY,i=t.height,s=l-t.top;r=.3*i>s?e:s>.7*i?e+1:e}this.rows.splice(r,0,i),this.render(),this.emitFormChange(),this.debugMode}}}moveColumn(e,t){this.debugMode;let a=null,l=-1,i=null;for(const t of this.rows){const r=t.columns.findIndex(t=>t.id===e);if(-1!==r){a=t,l=r;const e=t.columns[r];e&&(i=e);break}}if(!i||!a)return;const r=t.closest(".form-column"),n=t.closest(".form-row");if(r){const e=r.dataset.elementId;for(const t of this.rows){const n=t.columns.findIndex(t=>t.id===e);if(-1!==n){a.columns.splice(l,1);const e=r.getBoundingClientRect(),s=(event instanceof DragEvent?event.clientX:0)>e.left+e.width/2?n+1:n;t.columns.splice(s,0,i),this.redistributeColumnWidths(a),t!==a&&this.redistributeColumnWidths(t),this.render(),this.debugMode;break}}}else if(n){const e=n.dataset.rowId,t=this.rows.find(t=>t.id===e);t&&t!==a&&(a.columns.splice(l,1),t.columns.push(i),this.redistributeColumnWidths(a),this.redistributeColumnWidths(t),this.render(),this.debugMode)}}moveField(e,t){this.debugMode;let a=null,l=-1,i=null;for(const t of this.rows){for(const r of t.columns){const t=r.fields.findIndex(t=>t.id===e);if(-1!==t){a=r,l=t;const e=r.fields[t];e&&(i=e);break}}if(i)break}if(!i||!a)return;const r=t.closest(".form-column");if(r){const e=r.dataset.elementId;for(const t of this.rows)for(const r of t.columns)if(r.id===e)return a.fields.splice(l,1),r.fields.push(i),this.render(),void this.debugMode}}redistributeColumnWidths(e){const t=e.columns.length;if(0===t)return;const a=Math.floor(12/t),l=12%t;e.columns.forEach((e,t)=>{e.width=a+(l>t?1:0)})}getScopeDebugInfo(){return{...this.scopedDOM.getDebugInfo(),formBuilderInfo:{rowsCount:this.rows.length,totalElements:this.getTotalElementCount(),isLoaded:this.isLoaded,debugMode:this.debugMode}}}isElementInScope(e){return this.scopedDOM.isInScope(e)}getContainer(){return this.scopedDOM.getContainer()}getScopeId(){return this.scopedDOM.getScopeId()}destroy(){this.scopedDOM.cleanup(),this.rows=[],this.selectedElement=null,this.isLoaded=!1,this.container.removeAttribute("data-formbuilder-scope"),this.container.removeAttribute("data-fb-version"),this.container.removeAttribute("data-fb-initialized")}}const V="0.1.0",$={name:"AstraSmartForm",version:V,description:"Professional drag-and-drop form builder with TypeScript support by Astra Dev",author:"Astra Dev",license:"MIT",repository:"https://github.com/astradevio/astra-smartform",documentation:"https://docs.astradev.io/smartform"};export{AstraFormBuilder,s as BaseRenderer,f as BasicRenderer,y as BootstrapRenderer,r as DragDropManager,t as ElementRegistry,AstraFormBuilder as FormBuilder,n as JSONExporter,$ as LIBRARY_INFO,b as PreviewRenderer,i as PropertyPanel,g as RendererFactory,w as ScopedDOMManager,v as TailwindRenderer,l as Utils,V as VERSION};
//# sourceMappingURL=astra-form-builder.esm.min.js.map
